<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ciberseguridad ‚Äî Animaciones Garantizadas</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
  
  <style>
    :root{
      --accent-1: #00f0ff;
      --accent-2: #ff3d9a;
      --accent-3: #ffd400;
      --bg-dark: #071020;
      --card-radius: 16px;
      --light: #eafcff;
      --muted: #9fdcff;
      --content-bg: linear-gradient(120deg, rgba(10,30,60,0.98), rgba(2,10,30,0.98));
      --gradText: linear-gradient(90deg, #00f5ff, #7b61ff, #ff6a88, #ffd27a, #7effb2, #00f5ff);
    }
    *{box-sizing:border-box}
    body{ margin:0; min-height:100vh; font-family:"Montserrat",system-ui; background:var(--bg-dark); color:var(--light); }

    .page{ min-height:100vh; padding:48px 20px 88px; background:var(--content-bg); position:relative; overflow:hidden; perspective:1600px; }
    .page::before{ content:""; position:fixed; inset:-25%; z-index:-2; background: conic-gradient(from 0deg, #ff004d, #ff8a00, #ffee00, #00ff9d, #00b2ff, #9a00ff, #ff004d); background-size:220% 220%; filter:blur(44px) saturate(200%); opacity:0.18; transform:scale(1.02); animation:spin 20s linear infinite; mix-blend-mode:screen; }
    @keyframes spin{ 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }

    .float-shape{ position:absolute; width:220px; height:220px; border-radius:32px; filter:blur(40px); opacity:0.08; z-index:-1; }
    .s1{ right:6%; top:4%; background:linear-gradient(45deg,#00f0ff66,#7b61ff66); animation:floaty 10s ease-in-out infinite; }
    .s2{ left:4%; bottom:6%; background:linear-gradient(45deg,#ff6a8866,#ffd27a66); animation:floaty 14s ease-in-out infinite reverse; }
    @keyframes floaty{ 0%{transform:translateY(0) rotate(0)} 50%{transform:translateY(-30px) rotate(8deg)} 100%{transform:translateY(0) rotate(0)} }

    header{ max-width:1100px; margin:0 auto 18px; padding:6px 18px; }
    .title{ font-size:3.4rem; margin:0; line-height:1; font-weight:900; letter-spacing:-0.02em; background:var(--gradText); background-size:420% 100%; -webkit-background-clip:text; background-clip:text; color:transparent; animation:hueShift 4.6s linear infinite, titleBeams 3.6s ease-in-out infinite; text-shadow:0 12px 56px rgba(123,97,255,0.22); filter:saturate(1.55) contrast(1.05); }
    @keyframes hueShift{ 0%{background-position:0% 50%} 100%{background-position:100% 50%} }
    @keyframes titleBeams{ 0%,100%{filter:brightness(1) saturate(1.4)} 50%{filter:brightness(1.6) saturate(1.8) drop-shadow(0 18px 90px rgba(255,255,255,0.09))} }
    .title::after{ content:""; display:block; height:10px; width:72%; margin-top:10px; background:linear-gradient(90deg,#00f5ff88,#7b61ff88,#ff6a8888); filter:blur(28px); opacity:0.98; border-radius:12px; }
    .subtitle{ margin-top:12px; color:var(--muted); font-size:1rem; max-width:980px; }

    .grid{ max-width:1100px; margin:28px auto 0; display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:18px; }

    .card{
      padding:18px; border-radius:calc(var(--card-radius) + 4px); background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); border:1px solid rgba(255,255,255,0.035);
      box-shadow:0 14px 36px rgba(2,10,20,0.52); color:var(--light); display:flex; flex-direction:column; gap:10px; min-height:120px;
      transition:transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s, filter .28s; transform-origin:center center; opacity:0; transform:translateY(14px) scale(.99);
      position:relative; will-change:transform; cursor:pointer; overflow:visible; }

    .card.visible{ opacity:1; transform:translateY(0) scale(1); animation:popIn .6s cubic-bezier(.2,.9,.2,1); animation-delay:calc(var(--i,0) * 60ms); }
    @keyframes popIn{ 0%{opacity:0;transform:translateY(10px) scale(.992)} 100%{opacity:1;transform:translateY(0) scale(1)} }

    @keyframes danceXy{ 0%{transform:translateX(calc(var(--dance-range,8px) * -1)) translateY(0) rotate(-0.6deg)} 50%{transform:translateX(calc(var(--dance-range,8px))) translateY(2px) rotate(0.8deg)} 100%{transform:translateX(calc(var(--dance-range,8px) * -1)) translateY(0) rotate(-0.6deg)} }
    .card.dance{ animation:danceXy var(--dance-dur,4.8s) ease-in-out infinite; }

    .card:hover{ transform:translateY(-18px) scale(1.06) rotateZ(-0.8deg); box-shadow:0 46px 100px rgba(0,0,0,0.68), 0 0 38px rgba(255,106,136,0.06) inset; filter:brightness(1.04) saturate(1.08); z-index:6; }
    .card::after{ content:""; position:absolute; left:-12%; top:-20px; width:124%; height:200%; pointer-events:none; background:radial-gradient(500px 120px at 20% 10%, rgba(255,255,255,0.04), transparent 12%); transform:translateY(6px) rotate(2deg); opacity:0; transition:opacity .32s, transform .5s; border-radius:inherit; mix-blend-mode:screen; }
    .card:hover::after{ opacity:1; transform:translateY(-6px) rotate(-0.5deg); }

    .icon{ font-size:28px; width:54px; height:54px; display:inline-flex; align-items:center; justify-content:center; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); border:1px solid rgba(255,255,255,0.03); position:relative; z-index:2; }
    .icon i{ color:var(--accent-1); transition:transform .32s cubic-bezier(.2,.9,.2,1), color .28s, text-shadow .28s; font-size:20px; }
    .card:hover .icon i{ transform:translateY(-8px) scale(1.12) rotate(-8deg); color:var(--accent-2); text-shadow:0 8px 24px rgba(255,106,136,0.14); }

    .card h3{ margin:0; font-size:1.05rem; font-weight:900; letter-spacing:0.005em; position:relative; z-index:2; background:linear-gradient(90deg,#ffd27a,#ff6a88,#7b61ff); -webkit-background-clip:text; background-clip:text; color:transparent; filter:saturate(1.25); text-shadow:0 6px 24px rgba(255,106,136,0.06); }
    .card p{ margin:0; color:#dff7fb; line-height:1.45; font-size:0.95rem; position:relative; z-index:2; }

    .section-title{ font-size:1.6rem; margin:36px auto 8px; max-width:1100px; text-transform:uppercase; letter-spacing:0.08em; font-weight:900; background:linear-gradient(90deg,#00f5ff,#7b61ff,#ff6a88,#ffd27a,#7effb2); -webkit-background-clip:text; background-clip:text; color:transparent; text-shadow:0 10px 48px rgba(123,97,255,0.16); text-align:center; filter:saturate(1.45); }
    .section-sub{ max-width:1100px; margin:0 auto 18px; color:rgba(200,240,255,0.95); text-align:center }

    /* SISTEMA MODAL √öNICO Y A PRUEBA DE FALLAS */
    .universal-lightbox{ 
      position:fixed; inset:0; display:none !important; align-items:center; justify-content:center; 
      background:rgba(2,6,12,0.95); z-index:9999; padding:24px; 
      backdrop-filter:blur(10px); 
    }
    .universal-lightbox.active{ display:flex !important; }
    .universal-lightbox .frame{ 
      width:min(900px,95%); max-height:min(640px,90%); background:linear-gradient(180deg,#0a0f1a,#060a12); 
      border-radius:16px; overflow:hidden; position:relative; 
      box-shadow:0 40px 140px rgba(0,0,0,0.85); animation:lbPop .28s cubic-bezier(.2,.9,.2,1); 
      display:flex; flex-direction:column; border:1px solid rgba(255,255,255,0.08); 
    }
    @keyframes lbPop{ from{transform:scale(.92) rotateX(8deg);opacity:0} to{transform:scale(1) rotateX(0);opacity:1} }
    .universal-lightbox .close{ 
      position:absolute; right:14px; top:14px; z-index:10; 
      background:linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); 
      color:#fff; border-radius:10px; padding:12px 14px; border:0; cursor:pointer; 
      backdrop-filter:blur(6px); box-shadow:0 8px 30px rgba(0,0,0,0.6); 
      font-size:1.2rem; min-width:44px; min-height:44px; 
    }
    .universal-lightbox .content-title{ 
      margin:0; padding:18px 24px; background:rgba(255,255,255,0.02); 
      border-bottom:1px solid rgba(255,255,255,0.06); font-size:1.3rem; 
      font-weight:900; letter-spacing:0.05em; 
      background:linear-gradient(90deg,#00f5ff,#7b61ff); -webkit-background-clip:text; background-clip:text; color:transparent; 
    }
    .universal-lightbox .content-area{ 
      flex:1; padding:24px; display:flex; align-items:center; justify-content:center; 
      position:relative; overflow:hidden; min-height:400px; 
    }
    .universal-lightbox .scenario-element{ position:absolute; transition:all .3s ease; }

    /* ESCENARIOS PRE-CARGADOS (EVITA innerHTML) */
    .threat-scenario-data{ display:none !important; }
    .scenario-phishing{ width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:20px; }
    .scenario-malware{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; position:relative; }
    .scenario-ransomware{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; gap:15px; }
    .scenario-ddos{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; position:relative; }
    .scenario-bruteforce{ width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:20px; }
    .scenario-social{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; gap:30px; }
    .scenario-supply{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; gap:20px; }
    .scenario-cloud{ width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:20px; }
    .scenario-iot{ width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:30px; }
    .scenario-leak{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; position:relative; }

    .refs{ max-width:1100px; margin:28px auto 0; padding:18px; border-radius:12px; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.03); color:var(--muted); }
    .refs a{ color:var(--accent-1); text-decoration:underline; }

    /* DEBUG MODE - Muestra errores visuales */
    .debug-console{ position:fixed; bottom:10px; right:10px; background:#000; color:#0f0; padding:10px; border-radius:8px; font-family:monospace; font-size:12px; z-index:10000; display:none; max-width:300px; max-height:200px; overflow:auto; }
    body.debug .debug-console{ display:block; }

    @media (max-width:780px){ .title{font-size:1.9rem} .card{padding:14px} .icon{width:48px;height:48px} }
  </style>
</head>
<body>
  <!-- CONSOLA DE DEBUG (descomentar para ver errores) -->
  <!-- <div class="debug-console" id="debug"></div> -->

  <div class="page" role="main">
    <div class="float-shape s1" aria-hidden="true"></div>
    <div class="float-shape s2" aria-hidden="true"></div>

    <header>
      <h1 class="title">Ciberseguridad</h1>
      <p class="subtitle">Definici√≥n, principales amenazas y dec√°logo de buenas pr√°cticas.</p>
    </header>

    <section aria-label="Principales amenazas" class="content">
      <h2 class="section-title">PRINCIPALES AMENAZAS</h2>
      <p class="section-sub">Haz clic en cada amenaza para ver un ejemplo visual animado.</p>

      <div class="grid" id="threats">
        <!-- Cards con DATA para identificar el escenario -->
        <article class="card dance" data-threat="phishing" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-regular fa-envelope-open"></i></div>
          <h3>PHI$H!NG</h3>
          <p>Mensajes falsos que buscan enga√±ar para robar credenciales o datos bancarios.</p>
        </article>

        <article class="card dance" data-threat="malware" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-bug"></i></div>
          <h3>MŒõLWŒõRE</h3>
          <p>Software malicioso: virus, troyanos y spyware que da√±an o esp√≠an dispositivos.</p>
        </article>

        <article class="card dance" data-threat="ransomware" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-lock"></i></div>
          <h3>RŒîNS0MWŒîRE</h3>
          <p>Malware que cifra datos y exige rescate; mantener backups reduce impacto.</p>
        </article>

        <article class="card dance" data-threat="ddos" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-server"></i></div>
          <h3>DDO$</h3>
          <p>Ataques que saturan servidores con tr√°fico falso para interrumpir servicios.</p>
        </article>

        <article class="card dance" data-threat="bruteforce" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-key"></i></div>
          <h3>FUERZA BRUTA</h3>
          <p>Intentos automatizados para adivinar contrase√±as d√©biles mediante muchas combinaciones.</p>
        </article>

        <article class="card dance" data-threat="social" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-user-secret"></i></div>
          <h3>INGENIER√çA SOCIAL</h3>
          <p>Manipulaci√≥n psicol√≥gica para obtener acceso o informaci√≥n.</p>
        </article>

        <article class="card dance" data-threat="supply" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-truck-fast"></i></div>
          <h3>SUPPLY CHA!N</h3>
          <p>Comprometer proveedores o software de terceros para infiltrar plataformas leg√≠timas.</p>
        </article>

        <article class="card dance" data-threat="cloud" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-cloud"></i></div>
          <h3>NUBE</h3>
          <p>Errores de configuraci√≥n en cloud que permiten fugas de datos o accesos no autorizados.</p>
        </article>

        <article class="card dance" data-threat="iot" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-wifi"></i></div>
          <h3>I√òT</h3>
          <p>Dispositivos conectados sin protecciones que se convierten en puerta de entrada para atacantes.</p>
        </article>

        <article class="card dance" data-threat="leak" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-database"></i></div>
          <h3>DATA LEAK</h3>
          <p>Exposici√≥n o robo de informaci√≥n sensible que puede derivar en fraude o suplantaci√≥n.</p>
        </article>
      </div>
    </section>

    <!-- ESCENARIOS PRE-RENDERIZADOS (EVITA innerHTML) -->
    <div class="threat-scenario-data">
      <!-- Phishing -->
      <div id="scenario-phishing" class="scenario-phishing">
        <div class="scenario-element" style="font-size:4rem;animation:scenarioPulse 2s infinite;"><i class="fa-regular fa-envelope-open" style="color:var(--accent-1);"></i></div>
        <div class="scenario-element" style="font-size:3rem;animation:scenarioPulse 2s infinite .3s;"><i class="fa-solid fa-fish" style="color:var(--accent-2);"></i></div>
        <div style="position:relative;width:200px;height:8px;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));border-radius:4px;overflow:hidden;">
          <div style="position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,var(--light),transparent);animation:swipe 2s infinite;"></div>
        </div>
        <p style="color:var(--muted);text-align:center;margin-top:20px;">Mensaje leg√≠timo ‚Üí Anzuelo oculto ‚Üí Robo de credenciales</p>
        <style>@keyframes swipe{0%{left:-100%}100%{left:100%}} @keyframes scenarioPulse{0%,100%{opacity:.6;transform:scale(1)}50%{opacity:1;transform:scale(1.1)}}</style>
      </div>

      <!-- Malware -->
      <div id="scenario-malware" class="scenario-malware">
        <div class="scenario-element" style="font-size:5rem;z-index:2;"><i class="fa-solid fa-file" style="color:var(--accent-1);"></i></div>
        <div class="scenario-element" style="position:absolute;animation:bugSpread 3s infinite;"></div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Archivo infectado libera malware</div>
        <style>@keyframes bugSpread{0%{transform:scale(0);opacity:0}50%{transform:scale(2.5);opacity:.8}100%{transform:scale(4);opacity:0}} .scenario-malware .scenario-element:nth-child(2)::before{content:'ü¶†';font-size:3rem;position:absolute;animation:bugsFloat 2s infinite ease-in-out}@keyframes bugsFloat{0%,100%{transform:translate(0,0) rotate(0deg)}25%{transform:translate(20px,-20px) rotate(90deg)}50%{transform:translate(-20px,-30px) rotate(180deg)}75%{transform:translate(-30px,10px) rotate(270deg)}}</style>
      </div>

      <!-- Ransomware -->
      <div id="scenario-ransomware" class="scenario-ransomware">
        ${[...Array(6)].map((_,i) => `
          <div class="scenario-element" style="width:60px;height:80px;background:linear-gradient(180deg,#2a4a7a,#1a2a4a);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;animation:lockFiles 2s infinite;animation-delay:${i*.2}s;">
            <i class="fa-solid fa-file" style="color:var(--accent-1);"></i>
          </div>
        `).join('')}
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Cifrado progresivo de archivos</div>
        <style>@keyframes lockFiles{0%,100%{background:linear-gradient(180deg,#2a4a7a,#1a2a4a);transform:scale(1)}50%{background:linear-gradient(180deg,var(--accent-2),#7a1a4a);transform:scale(.95)}51%{transform:scale(.95) rotateY(180deg)}52%{transform:scale(.95) rotateY(180deg)}53%{transform:scale(.95) rotateY(0deg)}54%{transform:scale(.95) rotateY(0deg)}55%{transform:scale(1)}}</style>
      </div>

      <!-- DDoS -->
      <div id="scenario-ddos" class="scenario-ddos">
        <div class="scenario-element" style="font-size:4rem;z-index:2;"><i class="fa-solid fa-server" style="color:var(--accent-1);"></i></div>
        ${[...Array(12)].map((_,i) => `
          <div class="scenario-element" style="position:absolute;width:4px;height:40px;background:linear-gradient(180deg,var(--accent-3),var(--accent-2));border-radius:2px;transform-origin:bottom;animation:ddosPulse 1s infinite;animation-delay:${i*.08}s;transform:translate(-50%,-100%) rotate(${i*30}deg);"></div>
        `).join('')}
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">M√∫ltiples fuentes saturando el servidor</div>
        <style>.scenario-ddos .scenario-element:nth-child(n+2){--rotation:0deg;} @keyframes ddosPulse{0%{opacity:0;transform:translate(-50%,-100%) rotate(var(--rotation)) scaleY(0)}50%{opacity:1;transform:translate(-50%,-100%) rotate(var(--rotation)) scaleY(1)}100%{opacity:0;transform:translate(-50%,-120%) rotate(var(--rotation)) scaleY(1.2)}}</style>
      </div>

      <!-- Brute Force -->
      <div id="scenario-bruteforce" class="scenario-bruteforce">
        <div class="scenario-element" style="font-size:4rem;"><i class="fa-solid fa-lock" style="color:var(--accent-1);"></i></div>
        <div style="font-size:2rem;font-weight:900;font-family:monospace;letter-spacing:.2em;height:1.2em;display:flex;align-items:center;color:var(--accent-3);">
          <span class="scenario-element" style="animation:numbersChange .8s steps(10) infinite;"></span>
        </div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Probando combinaciones autom√°ticamente</div>
        <style>@keyframes numbersChange{0%{content:'0000'}10%{content:'1234'}20%{content:'5678'}30%{content:'9876'}40%{content:'4321'}50%{content:'1111'}60%{content:'2468'}70%{content:'1357'}80%{content:'9999'}90%{content:'0007'}100%{content:'0000'}} .scenario-bruteforce span::after{content:'0000';animation:numbersChange .8s steps(10) infinite}</style>
      </div>

      <!-- Social Engineering -->
      <div id="scenario-social" class="scenario-social">
        <div class="scenario-element" style="font-size:3rem;"><i class="fa-solid fa-user" style="color:var(--accent-1);"></i></div>
        <div class="scenario-element" style="font-size:2rem;animation:socialTalk 2s infinite;"><i class="fa-solid fa-comment-dots" style="color:var(--accent-2);"></i></div>
        <div class="scenario-element" style="font-size:3rem;opacity:.6;"><i class="fa-solid fa-user-shield" style="color:var(--accent-3);"></i></div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Manipulaci√≥n para obtener acceso</div>
        <style>@keyframes socialTalk{0%,100%{transform:translateX(0) scale(1)}25%{transform:translateX(10px) scale(1.1)}50%{transform:translateX(-10px) scale(1.1)}75%{transform:translateX(5px) scale(1.05)}}</style>
      </div>

      <!-- Supply Chain -->
      <div id="scenario-supply" class="scenario-supply">
        ${[...Array(3)].map((_,i) => `
          <div class="scenario-element" style="font-size:3rem;animation:supplyInfect 3s infinite;animation-delay:${i*.5}s;"><i class="fa-solid fa-box" style="color:var(--accent-1);"></i></div>
        `).join('')}
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Contaminaci√≥n propag√°ndose por la cadena</div>
        <style>@keyframes supplyInfect{0%,100%{filter:brightness(1) hue-rotate(0deg)}50%{filter:brightness(1.5) hue-rotate(180deg) drop-shadow(0 0 10px var(--accent-2))}}</style>
      </div>

      <!-- Cloud -->
      <div id="scenario-cloud" class="scenario-cloud">
        <div class="scenario-element" style="font-size:5rem;position:relative;">
          <i class="fa-solid fa-cloud" style="color:var(--accent-1);"></i>
          <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:2rem;animation:gearSpin 2s linear infinite;"><i class="fa-solid fa-gear" style="color:var(--accent-2);"></i></div>
        </div>
        <div class="scenario-element" style="display:flex;gap:10px;animation:dataLeak 1.5s infinite;">
          ${[...Array(3)].map(() => `<div style="width:8px;height:8px;background:var(--accent-3);border-radius:50%;"></div>`).join('')}
        </div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Configuraci√≥n incorrecta goteando datos</div>
        <style>@keyframes gearSpin{from{transform:translate(-50%,-50%) rotate(0deg)}to{transform:translate(-50%,-50%) rotate(360deg)}} @keyframes dataLeak{0%{transform:translateY(0);opacity:1}100%{transform:translateY(40px);opacity:0}}</style>
      </div>

      <!-- IoT -->
      <div id="scenario-iot" class="scenario-iot">
        <div style="display:flex;gap:20px;align-items:center;">
          <div class="scenario-element" style="font-size:2rem;"><i class="fa-solid fa-mobile-screen" style="color:var(--accent-1);"></i></div>
          <div class="scenario-element" style="font-size:2rem;"><i class="fa-solid fa-tv" style="color:var(--accent-1);"></i></div>
          <div class="scenario-element" style="font-size:2rem;"><i class="fa-solid fa-camera" style="color:var(--accent-1);"></i></div>
        </div>
        <div class="scenario-element" style="font-size:3rem;animation:routerPulse 1.5s infinite;"><i class="fa-solid fa-wifi" style="color:var(--accent-2);"></i></div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Dispositivos vulnerables conectados</div>
        <style>@keyframes routerPulse{0%,100%{transform:scale(1);filter:brightness(1)}50%{transform:scale(1.2);filter:brightness(1.5) drop-shadow(0 0 15px var(--accent-2))}}</style>
      </div>

      <!-- Data Leak -->
      <div id="scenario-leak" class="scenario-leak">
        <div class="scenario-element" style="font-size:5rem;"><i class="fa-solid fa-database" style="color:var(--accent-1);"></i></div>
        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100px;height:2px;background:var(--accent-2);animation:crackGrow 2s infinite;"></div>
        ${[...Array(8)].map((_,i) => `
          <div class="scenario-element" style="position:absolute;width:6px;height:6px;background:var(--accent-3);border-radius:50%;animation:dataDrop 2s infinite;animation-delay:${i*.15}s;left:${40+i*5}%;top:55%;"></div>
        `).join('')}
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Fuga de datos a trav√©s de brechas</div>
        <style>@keyframes crackGrow{0%,100%{width:0px;opacity:0}50%{width:100px;opacity:1}} @keyframes dataDrop{0%{transform:translateY(0) translateX(0);opacity:1}100%{transform:translateY(60px) translateX(${Math.random()*40-20}px);opacity:0}}</style>
      </div>
    </div>

    <!-- MODAL √öNICO (USADO PARA TODO) -->
    <div id="universal-lightbox" class="universal-lightbox" role="dialog" aria-hidden="true" aria-modal="true">
      <div class="frame">
        <button class="close" id="universal-close" aria-label="Cerrar ventana"><i class="fa-solid fa-xmark"></i></button>
        <h3 class="content-title" id="universal-title">T√≠tulo</h3>
        <div class="content-area" id="universal-content"></div>
      </div>
    </div>

    <!-- RESTO DEL CONTENIDO -->
    <div class="header-decal" style="max-width:1100px;margin:32px auto 0;padding:6px 18px;">
      <h2 class="section-title">DEC√ÅLOGO ‚Äî Buenas pr√°cticas</h2>
      <p class="section-sub">Diez acciones sencillas y efectivas para proteger cuentas, dispositivos y datos.</p>
    </div>

    <section class="grid" aria-label="Dec√°logo" id="rules">
      <article class="card dance"><div class="icon"><i class="fa-solid fa-lock"></i></div><h3>CONTRASE√ëAS</h3><p>Usa contrase√±as largas y √∫nicas; utiliza frases y un gestor cuando sea posible.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-shield-halved"></i></div><h3>MFA</h3><p>Activa autenticaci√≥n multifactor en servicios importantes.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-arrow-rotate-right"></i></div><h3>ACTUALIZA</h3><p>Mant√©n sistema y aplicaciones con los √∫ltimos parches de seguridad.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-shield-virus"></i></div><h3>ANTIVIRUS</h3><p>Instala y actualiza protecci√≥n antimalware donde proceda.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-copy"></i></div><h3>BACKUPS</h3><p>Realiza copias de seguridad peri√≥dicas y prueba restaurarlas.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-regular fa-envelope"></i></div><h3>CU√çDADO CON EMAILS</h3><p>No abras enlaces ni archivos de remitentes desconocidos; confirma antes.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-user-shield"></i></div><h3>PRIVACIDAD</h3><p>Revisa ajustes de privacidad y comparte lo m√≠nimo necesario en redes.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-wifi"></i></div><h3>REDES SEGURAS</h3><p>Evita Wi‚ÄëFi p√∫blicas para tr√°mites sensibles o usa VPN confiable.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-right-from-bracket"></i></div><h3>CIERRA SESI√ìN</h3><p>Descon√©ctate en equipos compartidos y bloquea dispositivos al ausentarte.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-chalkboard-user"></i></div><h3>INF√ìRMATE</h3><p>Consulta a responsables TI o fuentes oficiales ante dudas o incidentes.</p></article>
    </section>

    <!-- VISOR DE FOTOS (ahora usa el mismo modal) -->
    <div style="max-width:1100px;margin:42px auto 0;padding:6px 18px;">
      <h2 class="section-title">VISOR DE FOTOS</h2>
      <p class="section-sub">Haz clic en una imagen para verla.</p>
      <div style="display:flex;gap:12px;flex-wrap:wrap;">
        <button class="card visible" style="min-width:260px;cursor:pointer" data-image="https://drive.google.com/uc?export=view&id=1xPaqrSBADHyoigmlWjfOzqelXhZjTzgF" data-type="image">
          <div style="display:flex;gap:12px;align-items:center"><div class="icon"><i class="fa-solid fa-image"></i></div><div><h3 style="margin:0">Foto 1</h3><p style="margin:6px 0 0;color:#dff7fb;font-size:0.92rem">Abrir imagen proveniente de Drive</p></div></div>
        </button>
        <button class="card visible" style="min-width:260px;cursor:pointer" data-image="https://drive.google.com/uc?export=view&id=1hbnC6Waz5MnXrzdQIppWfcA2_Pde_ms9" data-type="image">
          <div style="display:flex;gap:12px;align-items:center"><div class="icon"><i class="fa-solid fa-photo-film"></i></div><div><h3 style="margin:0">Foto 2</h3><p style="margin:6px 0 0;color:#dff7fb;font-size:0.92rem">Abrir imagen proveniente de Drive</p></div></div>
        </button>
      </div>
    </div>

    <aside class="refs" aria-label="Referencias recomendadas">
      <strong>Sugerencias y referencias √∫tiles</strong>
      <ul style="margin:12px 0 0 18px; color:var(--muted)">
        <li><a href="https://www.ibm.com/es-es/topics/cybersecurity" target="_blank" rel="noopener">IBM ‚Äî Qu√© es la ciberseguridad</a>.</li>
        <li><a href="https://www.incibe.es/" target="_blank" rel="noopener">INCIBE ‚Äî Instituto Nacional de Ciberseguridad (Espa√±a)</a>.</li>
        <li><a href="https://www.pantallasamigas.net/" target="_blank" rel="noopener">PantallasAmigas ‚Äî recursos para menores y familias</a>.</li>
      </ul>
    </aside>

    <footer style="text-align:center; margin-top:42px; color:var(--muted);">Hecho para clase</footer>
  </div>

  <!-- SISTEMA DE DEBUG (descomentar para activar) -->
  <!--
  <script>
    const DEBUG_MODE = true;
    const debugLog = (msg) => {
      if(DEBUG_MODE){
        console.log('[DEBUG]', msg);
        const debugEl = document.getElementById('debug');
        if(debugEl) debugEl.innerHTML += msg + '<br>';
      }
    };
  </script>
  -->

  <script>
    // SISTEMA MODAL √öNICO - GARANTIZADO
    const modal = document.getElementById('universal-lightbox');
    const modalTitle = document.getElementById('universal-title');
    const modalContent = document.getElementById('universal-content');
    const modalClose = document.getElementById('universal-close');

    // LISTAS BLANCAS DE CONTENIDO PERMITIDO
    const ALLOWED_IMAGES = [
      'https://drive.google.com/uc?export=view&id=1xPaqrSBADHyoigmlWjfOzqelXhZjTzgF',
      'https://drive.google.com/uc?export=view&id=1hbnC6Waz5MnXrzdQIppWfcA2_Pde_ms9'
    ];

    const ALLOWED_THREATS = ['phishing','malware','ransomware','ddos','bruteforce','social','supply','cloud','iot','leak'];

    // FUNCION DE APERTURA ROBUSTA
    function openModal(type, identifier) {
      try {
        // Limpiar contenido previo
        modalContent.innerHTML = '';
        modal.classList.remove('active');
        
        if(type === 'threat') {
          // VERIFICAR QUE LA AMENAZA EST√Å PERMITIDA
          if(!ALLOWED_THREATS.includes(identifier)) {
            console.error('Amenaza no permitida:', identifier);
            return;
          }
          
          // CLONAR EL ESCENARIO PRE-CARGADO (NO innerHTML)
          const scenarioTemplate = document.getElementById(`scenario-${identifier}`);
          if(!scenarioTemplate) {
            console.error('Escenario no encontrado:', identifier);
            return;
          }
          
          const clone = scenarioTemplate.cloneNode(true);
          clone.style.display = 'flex'; // Mostrar el clon
          clone.id = `active-${identifier}`; // Evitar IDs duplicados
          modalContent.appendChild(clone);
          
          modalTitle.textContent = `üîç Ejemplo de ${identifier.toUpperCase()}`;
          
        } else if(type === 'image') {
          // VERIFICAR QUE LA IMAGEN EST√Å PERMITIDA
          if(!ALLOWED_IMAGES.includes(identifier)) {
            console.error('Imagen no permitida:', identifier);
            alert('Imagen no permitida');
            return;
          }
          
          // Crear iframe para imagen
          const iframe = document.createElement('iframe');
          iframe.src = identifier;
          iframe.style.cssText = 'width:100%;height:100%;border:0;display:block;background:#000';
          iframe.allow = 'accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture';
          modalContent.appendChild(iframe);
          modalTitle.textContent = 'üñºÔ∏è Visor de Imagen';
        }
        
        // MOSTRAR MODAL CON GARANT√çA
        modal.classList.add('active');
        modal.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
        
        // FOCUS TRAP PARA ACCESIBILIDAD
        modalClose.focus();
        
      } catch(error) {
        console.error('Error al abrir modal:', error);
      }
    }

    // FUNCION DE CIERRE GARANTIZADO
    function closeModal() {
      try {
        modal.classList.remove('active');
        modal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
        
        // Limpiar despu√©s de la animaci√≥n
        setTimeout(() => {
          modalContent.innerHTML = '';
          modalTitle.textContent = '';
        }, 300);
        
      } catch(error) {
        console.error('Error al cerrar modal:', error);
      }
    }

    // EVENT LISTENERS CON CAPTURA Y PREVENCI√ìN DE ERRORES
    try {
      // CERRAR POR BOT√ìN
      modalClose.addEventListener('click', closeModal, { once: false });
      
      // CERRAR POR TECLA ESCAPE
      document.addEventListener('keydown', (e) => {
        if(e.key === 'Escape' && modal.classList.contains('active')) {
          e.preventDefault();
          closeModal();
        }
      }, { passive: false });
      
      // CERRAR POR CLIC EN BACKDROP
      modal.addEventListener('click', (e) => {
        if(e.target === modal) {
          closeModal();
        }
      });
      
      // ABRIR DESDE CARDS DE AMENAZA
      document.querySelectorAll('[data-type="threat"]').forEach(card => {
        card.addEventListener('click', (e) => {
          e.stopPropagation();
          const threat = card.dataset.threat;
          openModal('threat', threat);
        });
        
        // ACCESIBILIDAD: TECLADO
        card.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            card.click();
          }
        });
      });
      
      // ABRIR DESDE CARDS DE IMAGEN
      document.querySelectorAll('[data-type="image"]').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const imageUrl = btn.dataset.image;
          openModal('image', imageUrl);
        });
        
        // ACCESIBILIDAD: TECLADO
        btn.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            btn.click();
          }
        });
      });
      
    } catch(error) {
      console.error('Error al configurar eventos:', error);
    }

    // REVEAL DE CARDS (c√≥digo original optimizado)
    const gridCards = document.querySelectorAll('.grid .card');
    const obs = new IntersectionObserver((entries, o) => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          const idx = Array.from(gridCards).indexOf(entry.target);
          entry.target.style.setProperty('--i', idx);
          const baseRange = 8 + (idx % 3) * 4;
          const range = baseRange + Math.round(Math.random()*6) + 'px';
          const dur = (3.6 + Math.random()*2.2).toFixed(2) + 's';
          const delay = (Math.random()*500).toFixed(0) + 'ms';
          entry.target.style.setProperty('--dance-range', range);
          entry.target.style.setProperty('--dance-dur', dur);
          entry.target.style.animationDelay = delay;
          entry.target.classList.add('visible');
          entry.target.classList.add('dance');
          o.unobserve(entry.target);
        }
      });
    }, { threshold: 0.12, rootMargin: '50px' });
    gridCards.forEach(c => obs.observe(c));

    // EFECTOS 3D Y SPARKS
    allCards = document.querySelectorAll('.card');
    allCards.forEach(card => {
      card.style.transition = 'transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s';
      card.addEventListener('mousemove', (e) => {
        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left; const y = e.clientY - rect.top;
        const cx = rect.width/2; const cy = rect.height/2;
        const dx = (x-cx)/cx; const dy = (y-cy)/cy;
        const rx = (dy * 6).toFixed(2); const ry = (-dx * 8).toFixed(2);
        card.style.transform = `translateY(-18px) scale(1.06) rotateX(${rx}deg) rotateY(${ry}deg) rotateZ(-0.6deg)`;
      });
      card.addEventListener('mouseenter', (e) => {
        card.style.transition='transform .12s cubic-bezier(.2,.9,.2,1), box-shadow .22s';
        for(let i=0;i<3;i++) createSpark(card, 4 + Math.random()*6);
      });
      card.addEventListener('mouseleave', ()=>{ 
        card.style.transition='transform .45s cubic-bezier(.2,.9,.2,1), box-shadow .35s'; 
        card.style.transform=''; 
      });
      const tinyShake = () => {
        if(card.matches(':hover')){ setTimeout(tinyShake, 1000 + Math.random()*2000); return; }
        const tx = (Math.random()*6 -3).toFixed(2); const ty = (Math.random()*4 -2).toFixed(2); const rot = (Math.random()*1 -0.5).toFixed(2);
        card.animate([{transform:`translate(${tx}px,${ty}px) rotate(${rot}deg)`},{transform:'translate(0px,0px) rotate(0deg)'}], {duration:420+Math.random()*600,easing:'ease-in-out'});
        setTimeout(tinyShake, 1500 + Math.random()*2600);
      };
      setTimeout(tinyShake, 400 + Math.random()*900);
    });

    function createSpark(card, size){
      const s = document.createElement('span'); s.className='spark';
      const colors = ['#fff8c6','#ffd5e8','#bff8ff','#ffd27a'];
      s.style.background = colors[Math.floor(Math.random()*colors.length)];
      const rw = card.getBoundingClientRect();
      s.style.left = Math.random()*(rw.width-20) + 'px';
      s.style.top = Math.random()*(rw.height-20) + 'px';
      s.style.opacity = '0';
      card.appendChild(s);
      s.style.width = s.style.height = (size||6) + 'px';
      const anim = s.animate([{opacity:0,transform:'scale(0.4) translateY(6px) rotate(0deg)'},{opacity:1,transform:'scale(1.1) translateY(-6px) rotate(30deg)'},{opacity:0,transform:'scale(0.6) translateY(-14px) rotate(60deg)'}], {duration:380+Math.random()*520,easing:'cubic-bezier(.2,.9,.2,1)'});
      anim.onfinish = () => s.remove();
    }

    // REDUCED MOTION
    const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
    if(mq.matches){ document.querySelectorAll('.card').forEach(c=>{ c.style.animation='none'; c.style.transition='none'; }); document.querySelectorAll('.float-shape').forEach(s=>s.style.animation='none'); }

    // GARANT√çA: Si algo falla, mostrar error visible
    window.addEventListener('error', (e) => {
      console.error('ERROR CR√çTICO:', e.error);
      document.body.innerHTML += `<div style="position:fixed;bottom:0;left:0;right:0;background:#ff004d;color:#fff;padding:10px;z-index:99999;font-family:monospace;">ERROR: ${e.message}. Revise la consola (F12)</div>`;
    });
  </script>
</body>
</html><!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ciberseguridad ‚Äî Animaciones Garantizadas</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
  
  <style>
    :root{
      --accent-1: #00f0ff;
      --accent-2: #ff3d9a;
      --accent-3: #ffd400;
      --bg-dark: #071020;
      --card-radius: 16px;
      --light: #eafcff;
      --muted: #9fdcff;
      --content-bg: linear-gradient(120deg, rgba(10,30,60,0.98), rgba(2,10,30,0.98));
      --gradText: linear-gradient(90deg, #00f5ff, #7b61ff, #ff6a88, #ffd27a, #7effb2, #00f5ff);
    }
    *{box-sizing:border-box}
    body{ margin:0; min-height:100vh; font-family:"Montserrat",system-ui; background:var(--bg-dark); color:var(--light); }

    .page{ min-height:100vh; padding:48px 20px 88px; background:var(--content-bg); position:relative; overflow:hidden; perspective:1600px; }
    .page::before{ content:""; position:fixed; inset:-25%; z-index:-2; background: conic-gradient(from 0deg, #ff004d, #ff8a00, #ffee00, #00ff9d, #00b2ff, #9a00ff, #ff004d); background-size:220% 220%; filter:blur(44px) saturate(200%); opacity:0.18; transform:scale(1.02); animation:spin 20s linear infinite; mix-blend-mode:screen; }
    @keyframes spin{ 0%{transform:rotate(0)} 100%{transform:rotate(360deg)} }

    .float-shape{ position:absolute; width:220px; height:220px; border-radius:32px; filter:blur(40px); opacity:0.08; z-index:-1; }
    .s1{ right:6%; top:4%; background:linear-gradient(45deg,#00f0ff66,#7b61ff66); animation:floaty 10s ease-in-out infinite; }
    .s2{ left:4%; bottom:6%; background:linear-gradient(45deg,#ff6a8866,#ffd27a66); animation:floaty 14s ease-in-out infinite reverse; }
    @keyframes floaty{ 0%{transform:translateY(0) rotate(0)} 50%{transform:translateY(-30px) rotate(8deg)} 100%{transform:translateY(0) rotate(0)} }

    header{ max-width:1100px; margin:0 auto 18px; padding:6px 18px; }
    .title{ font-size:3.4rem; margin:0; line-height:1; font-weight:900; letter-spacing:-0.02em; background:var(--gradText); background-size:420% 100%; -webkit-background-clip:text; background-clip:text; color:transparent; animation:hueShift 4.6s linear infinite, titleBeams 3.6s ease-in-out infinite; text-shadow:0 12px 56px rgba(123,97,255,0.22); filter:saturate(1.55) contrast(1.05); }
    @keyframes hueShift{ 0%{background-position:0% 50%} 100%{background-position:100% 50%} }
    @keyframes titleBeams{ 0%,100%{filter:brightness(1) saturate(1.4)} 50%{filter:brightness(1.6) saturate(1.8) drop-shadow(0 18px 90px rgba(255,255,255,0.09))} }
    .title::after{ content:""; display:block; height:10px; width:72%; margin-top:10px; background:linear-gradient(90deg,#00f5ff88,#7b61ff88,#ff6a8888); filter:blur(28px); opacity:0.98; border-radius:12px; }
    .subtitle{ margin-top:12px; color:var(--muted); font-size:1rem; max-width:980px; }

    .grid{ max-width:1100px; margin:28px auto 0; display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:18px; }

    .card{
      padding:18px; border-radius:calc(var(--card-radius) + 4px); background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); border:1px solid rgba(255,255,255,0.035);
      box-shadow:0 14px 36px rgba(2,10,20,0.52); color:var(--light); display:flex; flex-direction:column; gap:10px; min-height:120px;
      transition:transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s, filter .28s; transform-origin:center center; opacity:0; transform:translateY(14px) scale(.99);
      position:relative; will-change:transform; cursor:pointer; overflow:visible; }

    .card.visible{ opacity:1; transform:translateY(0) scale(1); animation:popIn .6s cubic-bezier(.2,.9,.2,1); animation-delay:calc(var(--i,0) * 60ms); }
    @keyframes popIn{ 0%{opacity:0;transform:translateY(10px) scale(.992)} 100%{opacity:1;transform:translateY(0) scale(1)} }

    @keyframes danceXy{ 0%{transform:translateX(calc(var(--dance-range,8px) * -1)) translateY(0) rotate(-0.6deg)} 50%{transform:translateX(calc(var(--dance-range,8px))) translateY(2px) rotate(0.8deg)} 100%{transform:translateX(calc(var(--dance-range,8px) * -1)) translateY(0) rotate(-0.6deg)} }
    .card.dance{ animation:danceXy var(--dance-dur,4.8s) ease-in-out infinite; }

    .card:hover{ transform:translateY(-18px) scale(1.06) rotateZ(-0.8deg); box-shadow:0 46px 100px rgba(0,0,0,0.68), 0 0 38px rgba(255,106,136,0.06) inset; filter:brightness(1.04) saturate(1.08); z-index:6; }
    .card::after{ content:""; position:absolute; left:-12%; top:-20px; width:124%; height:200%; pointer-events:none; background:radial-gradient(500px 120px at 20% 10%, rgba(255,255,255,0.04), transparent 12%); transform:translateY(6px) rotate(2deg); opacity:0; transition:opacity .32s, transform .5s; border-radius:inherit; mix-blend-mode:screen; }
    .card:hover::after{ opacity:1; transform:translateY(-6px) rotate(-0.5deg); }

    .icon{ font-size:28px; width:54px; height:54px; display:inline-flex; align-items:center; justify-content:center; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02)); border:1px solid rgba(255,255,255,0.03); position:relative; z-index:2; }
    .icon i{ color:var(--accent-1); transition:transform .32s cubic-bezier(.2,.9,.2,1), color .28s, text-shadow .28s; font-size:20px; }
    .card:hover .icon i{ transform:translateY(-8px) scale(1.12) rotate(-8deg); color:var(--accent-2); text-shadow:0 8px 24px rgba(255,106,136,0.14); }

    .card h3{ margin:0; font-size:1.05rem; font-weight:900; letter-spacing:0.005em; position:relative; z-index:2; background:linear-gradient(90deg,#ffd27a,#ff6a88,#7b61ff); -webkit-background-clip:text; background-clip:text; color:transparent; filter:saturate(1.25); text-shadow:0 6px 24px rgba(255,106,136,0.06); }
    .card p{ margin:0; color:#dff7fb; line-height:1.45; font-size:0.95rem; position:relative; z-index:2; }

    .section-title{ font-size:1.6rem; margin:36px auto 8px; max-width:1100px; text-transform:uppercase; letter-spacing:0.08em; font-weight:900; background:linear-gradient(90deg,#00f5ff,#7b61ff,#ff6a88,#ffd27a,#7effb2); -webkit-background-clip:text; background-clip:text; color:transparent; text-shadow:0 10px 48px rgba(123,97,255,0.16); text-align:center; filter:saturate(1.45); }
    .section-sub{ max-width:1100px; margin:0 auto 18px; color:rgba(200,240,255,0.95); text-align:center }

    /* SISTEMA MODAL √öNICO Y A PRUEBA DE FALLAS */
    .universal-lightbox{ 
      position:fixed; inset:0; display:none !important; align-items:center; justify-content:center; 
      background:rgba(2,6,12,0.95); z-index:9999; padding:24px; 
      backdrop-filter:blur(10px); 
    }
    .universal-lightbox.active{ display:flex !important; }
    .universal-lightbox .frame{ 
      width:min(900px,95%); max-height:min(640px,90%); background:linear-gradient(180deg,#0a0f1a,#060a12); 
      border-radius:16px; overflow:hidden; position:relative; 
      box-shadow:0 40px 140px rgba(0,0,0,0.85); animation:lbPop .28s cubic-bezier(.2,.9,.2,1); 
      display:flex; flex-direction:column; border:1px solid rgba(255,255,255,0.08); 
    }
    @keyframes lbPop{ from{transform:scale(.92) rotateX(8deg);opacity:0} to{transform:scale(1) rotateX(0);opacity:1} }
    .universal-lightbox .close{ 
      position:absolute; right:14px; top:14px; z-index:10; 
      background:linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); 
      color:#fff; border-radius:10px; padding:12px 14px; border:0; cursor:pointer; 
      backdrop-filter:blur(6px); box-shadow:0 8px 30px rgba(0,0,0,0.6); 
      font-size:1.2rem; min-width:44px; min-height:44px; 
    }
    .universal-lightbox .content-title{ 
      margin:0; padding:18px 24px; background:rgba(255,255,255,0.02); 
      border-bottom:1px solid rgba(255,255,255,0.06); font-size:1.3rem; 
      font-weight:900; letter-spacing:0.05em; 
      background:linear-gradient(90deg,#00f5ff,#7b61ff); -webkit-background-clip:text; background-clip:text; color:transparent; 
    }
    .universal-lightbox .content-area{ 
      flex:1; padding:24px; display:flex; align-items:center; justify-content:center; 
      position:relative; overflow:hidden; min-height:400px; 
    }
    .universal-lightbox .scenario-element{ position:absolute; transition:all .3s ease; }

    /* ESCENARIOS PRE-CARGADOS (EVITA innerHTML) */
    .threat-scenario-data{ display:none !important; }
    .scenario-phishing{ width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:20px; }
    .scenario-malware{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; position:relative; }
    .scenario-ransomware{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; gap:15px; }
    .scenario-ddos{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; position:relative; }
    .scenario-bruteforce{ width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:20px; }
    .scenario-social{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; gap:30px; }
    .scenario-supply{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; gap:20px; }
    .scenario-cloud{ width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:20px; }
    .scenario-iot{ width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:30px; }
    .scenario-leak{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; position:relative; }

    .refs{ max-width:1100px; margin:28px auto 0; padding:18px; border-radius:12px; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.03); color:var(--muted); }
    .refs a{ color:var(--accent-1); text-decoration:underline; }

    /* DEBUG MODE - Muestra errores visuales */
    .debug-console{ position:fixed; bottom:10px; right:10px; background:#000; color:#0f0; padding:10px; border-radius:8px; font-family:monospace; font-size:12px; z-index:10000; display:none; max-width:300px; max-height:200px; overflow:auto; }
    body.debug .debug-console{ display:block; }

    @media (max-width:780px){ .title{font-size:1.9rem} .card{padding:14px} .icon{width:48px;height:48px} }
  </style>
</head>
<body>
  <!-- CONSOLA DE DEBUG (descomentar para ver errores) -->
  <!-- <div class="debug-console" id="debug"></div> -->

  <div class="page" role="main">
    <div class="float-shape s1" aria-hidden="true"></div>
    <div class="float-shape s2" aria-hidden="true"></div>

    <header>
      <h1 class="title">Ciberseguridad</h1>
      <p class="subtitle">Definici√≥n, principales amenazas y dec√°logo de buenas pr√°cticas.</p>
    </header>

    <section aria-label="Principales amenazas" class="content">
      <h2 class="section-title">PRINCIPALES AMENAZAS</h2>
      <p class="section-sub">Haz clic en cada amenaza para ver un ejemplo visual animado.</p>

      <div class="grid" id="threats">
        <!-- Cards con DATA para identificar el escenario -->
        <article class="card dance" data-threat="phishing" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-regular fa-envelope-open"></i></div>
          <h3>PHI$H!NG</h3>
          <p>Mensajes falsos que buscan enga√±ar para robar credenciales o datos bancarios.</p>
        </article>

        <article class="card dance" data-threat="malware" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-bug"></i></div>
          <h3>MŒõLWŒõRE</h3>
          <p>Software malicioso: virus, troyanos y spyware que da√±an o esp√≠an dispositivos.</p>
        </article>

        <article class="card dance" data-threat="ransomware" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-lock"></i></div>
          <h3>RŒîNS0MWŒîRE</h3>
          <p>Malware que cifra datos y exige rescate; mantener backups reduce impacto.</p>
        </article>

        <article class="card dance" data-threat="ddos" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-server"></i></div>
          <h3>DDO$</h3>
          <p>Ataques que saturan servidores con tr√°fico falso para interrumpir servicios.</p>
        </article>

        <article class="card dance" data-threat="bruteforce" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-key"></i></div>
          <h3>FUERZA BRUTA</h3>
          <p>Intentos automatizados para adivinar contrase√±as d√©biles mediante muchas combinaciones.</p>
        </article>

        <article class="card dance" data-threat="social" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-user-secret"></i></div>
          <h3>INGENIER√çA SOCIAL</h3>
          <p>Manipulaci√≥n psicol√≥gica para obtener acceso o informaci√≥n.</p>
        </article>

        <article class="card dance" data-threat="supply" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-truck-fast"></i></div>
          <h3>SUPPLY CHA!N</h3>
          <p>Comprometer proveedores o software de terceros para infiltrar plataformas leg√≠timas.</p>
        </article>

        <article class="card dance" data-threat="cloud" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-cloud"></i></div>
          <h3>NUBE</h3>
          <p>Errores de configuraci√≥n en cloud que permiten fugas de datos o accesos no autorizados.</p>
        </article>

        <article class="card dance" data-threat="iot" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-wifi"></i></div>
          <h3>I√òT</h3>
          <p>Dispositivos conectados sin protecciones que se convierten en puerta de entrada para atacantes.</p>
        </article>

        <article class="card dance" data-threat="leak" data-type="threat" role="button" tabindex="0">
          <div class="icon"><i class="fa-solid fa-database"></i></div>
          <h3>DATA LEAK</h3>
          <p>Exposici√≥n o robo de informaci√≥n sensible que puede derivar en fraude o suplantaci√≥n.</p>
        </article>
      </div>
    </section>

    <!-- ESCENARIOS PRE-RENDERIZADOS (EVITA innerHTML) -->
    <div class="threat-scenario-data">
      <!-- Phishing -->
      <div id="scenario-phishing" class="scenario-phishing">
        <div class="scenario-element" style="font-size:4rem;animation:scenarioPulse 2s infinite;"><i class="fa-regular fa-envelope-open" style="color:var(--accent-1);"></i></div>
        <div class="scenario-element" style="font-size:3rem;animation:scenarioPulse 2s infinite .3s;"><i class="fa-solid fa-fish" style="color:var(--accent-2);"></i></div>
        <div style="position:relative;width:200px;height:8px;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));border-radius:4px;overflow:hidden;">
          <div style="position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,var(--light),transparent);animation:swipe 2s infinite;"></div>
        </div>
        <p style="color:var(--muted);text-align:center;margin-top:20px;">Mensaje leg√≠timo ‚Üí Anzuelo oculto ‚Üí Robo de credenciales</p>
        <style>@keyframes swipe{0%{left:-100%}100%{left:100%}} @keyframes scenarioPulse{0%,100%{opacity:.6;transform:scale(1)}50%{opacity:1;transform:scale(1.1)}}</style>
      </div>

      <!-- Malware -->
      <div id="scenario-malware" class="scenario-malware">
        <div class="scenario-element" style="font-size:5rem;z-index:2;"><i class="fa-solid fa-file" style="color:var(--accent-1);"></i></div>
        <div class="scenario-element" style="position:absolute;animation:bugSpread 3s infinite;"></div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Archivo infectado libera malware</div>
        <style>@keyframes bugSpread{0%{transform:scale(0);opacity:0}50%{transform:scale(2.5);opacity:.8}100%{transform:scale(4);opacity:0}} .scenario-malware .scenario-element:nth-child(2)::before{content:'ü¶†';font-size:3rem;position:absolute;animation:bugsFloat 2s infinite ease-in-out}@keyframes bugsFloat{0%,100%{transform:translate(0,0) rotate(0deg)}25%{transform:translate(20px,-20px) rotate(90deg)}50%{transform:translate(-20px,-30px) rotate(180deg)}75%{transform:translate(-30px,10px) rotate(270deg)}}</style>
      </div>

      <!-- Ransomware -->
      <div id="scenario-ransomware" class="scenario-ransomware">
        ${[...Array(6)].map((_,i) => `
          <div class="scenario-element" style="width:60px;height:80px;background:linear-gradient(180deg,#2a4a7a,#1a2a4a);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;animation:lockFiles 2s infinite;animation-delay:${i*.2}s;">
            <i class="fa-solid fa-file" style="color:var(--accent-1);"></i>
          </div>
        `).join('')}
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Cifrado progresivo de archivos</div>
        <style>@keyframes lockFiles{0%,100%{background:linear-gradient(180deg,#2a4a7a,#1a2a4a);transform:scale(1)}50%{background:linear-gradient(180deg,var(--accent-2),#7a1a4a);transform:scale(.95)}51%{transform:scale(.95) rotateY(180deg)}52%{transform:scale(.95) rotateY(180deg)}53%{transform:scale(.95) rotateY(0deg)}54%{transform:scale(.95) rotateY(0deg)}55%{transform:scale(1)}}</style>
      </div>

      <!-- DDoS -->
      <div id="scenario-ddos" class="scenario-ddos">
        <div class="scenario-element" style="font-size:4rem;z-index:2;"><i class="fa-solid fa-server" style="color:var(--accent-1);"></i></div>
        ${[...Array(12)].map((_,i) => `
          <div class="scenario-element" style="position:absolute;width:4px;height:40px;background:linear-gradient(180deg,var(--accent-3),var(--accent-2));border-radius:2px;transform-origin:bottom;animation:ddosPulse 1s infinite;animation-delay:${i*.08}s;transform:translate(-50%,-100%) rotate(${i*30}deg);"></div>
        `).join('')}
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">M√∫ltiples fuentes saturando el servidor</div>
        <style>.scenario-ddos .scenario-element:nth-child(n+2){--rotation:0deg;} @keyframes ddosPulse{0%{opacity:0;transform:translate(-50%,-100%) rotate(var(--rotation)) scaleY(0)}50%{opacity:1;transform:translate(-50%,-100%) rotate(var(--rotation)) scaleY(1)}100%{opacity:0;transform:translate(-50%,-120%) rotate(var(--rotation)) scaleY(1.2)}}</style>
      </div>

      <!-- Brute Force -->
      <div id="scenario-bruteforce" class="scenario-bruteforce">
        <div class="scenario-element" style="font-size:4rem;"><i class="fa-solid fa-lock" style="color:var(--accent-1);"></i></div>
        <div style="font-size:2rem;font-weight:900;font-family:monospace;letter-spacing:.2em;height:1.2em;display:flex;align-items:center;color:var(--accent-3);">
          <span class="scenario-element" style="animation:numbersChange .8s steps(10) infinite;"></span>
        </div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Probando combinaciones autom√°ticamente</div>
        <style>@keyframes numbersChange{0%{content:'0000'}10%{content:'1234'}20%{content:'5678'}30%{content:'9876'}40%{content:'4321'}50%{content:'1111'}60%{content:'2468'}70%{content:'1357'}80%{content:'9999'}90%{content:'0007'}100%{content:'0000'}} .scenario-bruteforce span::after{content:'0000';animation:numbersChange .8s steps(10) infinite}</style>
      </div>

      <!-- Social Engineering -->
      <div id="scenario-social" class="scenario-social">
        <div class="scenario-element" style="font-size:3rem;"><i class="fa-solid fa-user" style="color:var(--accent-1);"></i></div>
        <div class="scenario-element" style="font-size:2rem;animation:socialTalk 2s infinite;"><i class="fa-solid fa-comment-dots" style="color:var(--accent-2);"></i></div>
        <div class="scenario-element" style="font-size:3rem;opacity:.6;"><i class="fa-solid fa-user-shield" style="color:var(--accent-3);"></i></div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Manipulaci√≥n para obtener acceso</div>
        <style>@keyframes socialTalk{0%,100%{transform:translateX(0) scale(1)}25%{transform:translateX(10px) scale(1.1)}50%{transform:translateX(-10px) scale(1.1)}75%{transform:translateX(5px) scale(1.05)}}</style>
      </div>

      <!-- Supply Chain -->
      <div id="scenario-supply" class="scenario-supply">
        ${[...Array(3)].map((_,i) => `
          <div class="scenario-element" style="font-size:3rem;animation:supplyInfect 3s infinite;animation-delay:${i*.5}s;"><i class="fa-solid fa-box" style="color:var(--accent-1);"></i></div>
        `).join('')}
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Contaminaci√≥n propag√°ndose por la cadena</div>
        <style>@keyframes supplyInfect{0%,100%{filter:brightness(1) hue-rotate(0deg)}50%{filter:brightness(1.5) hue-rotate(180deg) drop-shadow(0 0 10px var(--accent-2))}}</style>
      </div>

      <!-- Cloud -->
      <div id="scenario-cloud" class="scenario-cloud">
        <div class="scenario-element" style="font-size:5rem;position:relative;">
          <i class="fa-solid fa-cloud" style="color:var(--accent-1);"></i>
          <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:2rem;animation:gearSpin 2s linear infinite;"><i class="fa-solid fa-gear" style="color:var(--accent-2);"></i></div>
        </div>
        <div class="scenario-element" style="display:flex;gap:10px;animation:dataLeak 1.5s infinite;">
          ${[...Array(3)].map(() => `<div style="width:8px;height:8px;background:var(--accent-3);border-radius:50%;"></div>`).join('')}
        </div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Configuraci√≥n incorrecta goteando datos</div>
        <style>@keyframes gearSpin{from{transform:translate(-50%,-50%) rotate(0deg)}to{transform:translate(-50%,-50%) rotate(360deg)}} @keyframes dataLeak{0%{transform:translateY(0);opacity:1}100%{transform:translateY(40px);opacity:0}}</style>
      </div>

      <!-- IoT -->
      <div id="scenario-iot" class="scenario-iot">
        <div style="display:flex;gap:20px;align-items:center;">
          <div class="scenario-element" style="font-size:2rem;"><i class="fa-solid fa-mobile-screen" style="color:var(--accent-1);"></i></div>
          <div class="scenario-element" style="font-size:2rem;"><i class="fa-solid fa-tv" style="color:var(--accent-1);"></i></div>
          <div class="scenario-element" style="font-size:2rem;"><i class="fa-solid fa-camera" style="color:var(--accent-1);"></i></div>
        </div>
        <div class="scenario-element" style="font-size:3rem;animation:routerPulse 1.5s infinite;"><i class="fa-solid fa-wifi" style="color:var(--accent-2);"></i></div>
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Dispositivos vulnerables conectados</div>
        <style>@keyframes routerPulse{0%,100%{transform:scale(1);filter:brightness(1)}50%{transform:scale(1.2);filter:brightness(1.5) drop-shadow(0 0 15px var(--accent-2))}}</style>
      </div>

      <!-- Data Leak -->
      <div id="scenario-leak" class="scenario-leak">
        <div class="scenario-element" style="font-size:5rem;"><i class="fa-solid fa-database" style="color:var(--accent-1);"></i></div>
        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100px;height:2px;background:var(--accent-2);animation:crackGrow 2s infinite;"></div>
        ${[...Array(8)].map((_,i) => `
          <div class="scenario-element" style="position:absolute;width:6px;height:6px;background:var(--accent-3);border-radius:50%;animation:dataDrop 2s infinite;animation-delay:${i*.15}s;left:${40+i*5}%;top:55%;"></div>
        `).join('')}
        <div style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:var(--muted);">Fuga de datos a trav√©s de brechas</div>
        <style>@keyframes crackGrow{0%,100%{width:0px;opacity:0}50%{width:100px;opacity:1}} @keyframes dataDrop{0%{transform:translateY(0) translateX(0);opacity:1}100%{transform:translateY(60px) translateX(${Math.random()*40-20}px);opacity:0}}</style>
      </div>
    </div>

    <!-- MODAL √öNICO (USADO PARA TODO) -->
    <div id="universal-lightbox" class="universal-lightbox" role="dialog" aria-hidden="true" aria-modal="true">
      <div class="frame">
        <button class="close" id="universal-close" aria-label="Cerrar ventana"><i class="fa-solid fa-xmark"></i></button>
        <h3 class="content-title" id="universal-title">T√≠tulo</h3>
        <div class="content-area" id="universal-content"></div>
      </div>
    </div>

    <!-- RESTO DEL CONTENIDO -->
    <div class="header-decal" style="max-width:1100px;margin:32px auto 0;padding:6px 18px;">
      <h2 class="section-title">DEC√ÅLOGO ‚Äî Buenas pr√°cticas</h2>
      <p class="section-sub">Diez acciones sencillas y efectivas para proteger cuentas, dispositivos y datos.</p>
    </div>

    <section class="grid" aria-label="Dec√°logo" id="rules">
      <article class="card dance"><div class="icon"><i class="fa-solid fa-lock"></i></div><h3>CONTRASE√ëAS</h3><p>Usa contrase√±as largas y √∫nicas; utiliza frases y un gestor cuando sea posible.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-shield-halved"></i></div><h3>MFA</h3><p>Activa autenticaci√≥n multifactor en servicios importantes.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-arrow-rotate-right"></i></div><h3>ACTUALIZA</h3><p>Mant√©n sistema y aplicaciones con los √∫ltimos parches de seguridad.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-shield-virus"></i></div><h3>ANTIVIRUS</h3><p>Instala y actualiza protecci√≥n antimalware donde proceda.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-copy"></i></div><h3>BACKUPS</h3><p>Realiza copias de seguridad peri√≥dicas y prueba restaurarlas.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-regular fa-envelope"></i></div><h3>CU√çDADO CON EMAILS</h3><p>No abras enlaces ni archivos de remitentes desconocidos; confirma antes.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-user-shield"></i></div><h3>PRIVACIDAD</h3><p>Revisa ajustes de privacidad y comparte lo m√≠nimo necesario en redes.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-wifi"></i></div><h3>REDES SEGURAS</h3><p>Evita Wi‚ÄëFi p√∫blicas para tr√°mites sensibles o usa VPN confiable.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-right-from-bracket"></i></div><h3>CIERRA SESI√ìN</h3><p>Descon√©ctate en equipos compartidos y bloquea dispositivos al ausentarte.</p></article>
      <article class="card dance"><div class="icon"><i class="fa-solid fa-chalkboard-user"></i></div><h3>INF√ìRMATE</h3><p>Consulta a responsables TI o fuentes oficiales ante dudas o incidentes.</p></article>
    </section>

    <!-- VISOR DE FOTOS (ahora usa el mismo modal) -->
    <div style="max-width:1100px;margin:42px auto 0;padding:6px 18px;">
      <h2 class="section-title">VISOR DE FOTOS</h2>
      <p class="section-sub">Haz clic en una imagen para verla.</p>
      <div style="display:flex;gap:12px;flex-wrap:wrap;">
        <button class="card visible" style="min-width:260px;cursor:pointer" data-image="https://drive.google.com/uc?export=view&id=1xPaqrSBADHyoigmlWjfOzqelXhZjTzgF" data-type="image">
          <div style="display:flex;gap:12px;align-items:center"><div class="icon"><i class="fa-solid fa-image"></i></div><div><h3 style="margin:0">Foto 1</h3><p style="margin:6px 0 0;color:#dff7fb;font-size:0.92rem">Abrir imagen proveniente de Drive</p></div></div>
        </button>
        <button class="card visible" style="min-width:260px;cursor:pointer" data-image="https://drive.google.com/uc?export=view&id=1hbnC6Waz5MnXrzdQIppWfcA2_Pde_ms9" data-type="image">
          <div style="display:flex;gap:12px;align-items:center"><div class="icon"><i class="fa-solid fa-photo-film"></i></div><div><h3 style="margin:0">Foto 2</h3><p style="margin:6px 0 0;color:#dff7fb;font-size:0.92rem">Abrir imagen proveniente de Drive</p></div></div>
        </button>
      </div>
    </div>

    <aside class="refs" aria-label="Referencias recomendadas">
      <strong>Sugerencias y referencias √∫tiles</strong>
      <ul style="margin:12px 0 0 18px; color:var(--muted)">
        <li><a href="https://www.ibm.com/es-es/topics/cybersecurity" target="_blank" rel="noopener">IBM ‚Äî Qu√© es la ciberseguridad</a>.</li>
        <li><a href="https://www.incibe.es/" target="_blank" rel="noopener">INCIBE ‚Äî Instituto Nacional de Ciberseguridad (Espa√±a)</a>.</li>
        <li><a href="https://www.pantallasamigas.net/" target="_blank" rel="noopener">PantallasAmigas ‚Äî recursos para menores y familias</a>.</li>
      </ul>
    </aside>

    <footer style="text-align:center; margin-top:42px; color:var(--muted);">Hecho para clase</footer>
  </div>

  <!-- SISTEMA DE DEBUG (descomentar para activar) -->
  <!--
  <script>
    const DEBUG_MODE = true;
    const debugLog = (msg) => {
      if(DEBUG_MODE){
        console.log('[DEBUG]', msg);
        const debugEl = document.getElementById('debug');
        if(debugEl) debugEl.innerHTML += msg + '<br>';
      }
    };
  </script>
  -->

  <script>
    // SISTEMA MODAL √öNICO - GARANTIZADO
    const modal = document.getElementById('universal-lightbox');
    const modalTitle = document.getElementById('universal-title');
    const modalContent = document.getElementById('universal-content');
    const modalClose = document.getElementById('universal-close');

    // LISTAS BLANCAS DE CONTENIDO PERMITIDO
    const ALLOWED_IMAGES = [
      'https://drive.google.com/uc?export=view&id=1xPaqrSBADHyoigmlWjfOzqelXhZjTzgF',
      'https://drive.google.com/uc?export=view&id=1hbnC6Waz5MnXrzdQIppWfcA2_Pde_ms9'
    ];

    const ALLOWED_THREATS = ['phishing','malware','ransomware','ddos','bruteforce','social','supply','cloud','iot','leak'];

    // FUNCION DE APERTURA ROBUSTA
    function openModal(type, identifier) {
      try {
        // Limpiar contenido previo
        modalContent.innerHTML = '';
        modal.classList.remove('active');
        
        if(type === 'threat') {
          // VERIFICAR QUE LA AMENAZA EST√Å PERMITIDA
          if(!ALLOWED_THREATS.includes(identifier)) {
            console.error('Amenaza no permitida:', identifier);
            return;
          }
          
          // CLONAR EL ESCENARIO PRE-CARGADO (NO innerHTML)
          const scenarioTemplate = document.getElementById(`scenario-${identifier}`);
          if(!scenarioTemplate) {
            console.error('Escenario no encontrado:', identifier);
            return;
          }
          
          const clone = scenarioTemplate.cloneNode(true);
          clone.style.display = 'flex'; // Mostrar el clon
          clone.id = `active-${identifier}`; // Evitar IDs duplicados
          modalContent.appendChild(clone);
          
          modalTitle.textContent = `üîç Ejemplo de ${identifier.toUpperCase()}`;
          
        } else if(type === 'image') {
          // VERIFICAR QUE LA IMAGEN EST√Å PERMITIDA
          if(!ALLOWED_IMAGES.includes(identifier)) {
            console.error('Imagen no permitida:', identifier);
            alert('Imagen no permitida');
            return;
          }
          
          // Crear iframe para imagen
          const iframe = document.createElement('iframe');
          iframe.src = identifier;
          iframe.style.cssText = 'width:100%;height:100%;border:0;display:block;background:#000';
          iframe.allow = 'accelerometer;autoplay;clipboard-write;encrypted-media;gyroscope;picture-in-picture';
          modalContent.appendChild(iframe);
          modalTitle.textContent = 'üñºÔ∏è Visor de Imagen';
        }
        
        // MOSTRAR MODAL CON GARANT√çA
        modal.classList.add('active');
        modal.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
        
        // FOCUS TRAP PARA ACCESIBILIDAD
        modalClose.focus();
        
      } catch(error) {
        console.error('Error al abrir modal:', error);
      }
    }

    // FUNCION DE CIERRE GARANTIZADO
    function closeModal() {
      try {
        modal.classList.remove('active');
        modal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
        
        // Limpiar despu√©s de la animaci√≥n
        setTimeout(() => {
          modalContent.innerHTML = '';
          modalTitle.textContent = '';
        }, 300);
        
      } catch(error) {
        console.error('Error al cerrar modal:', error);
      }
    }

    // EVENT LISTENERS CON CAPTURA Y PREVENCI√ìN DE ERRORES
    try {
      // CERRAR POR BOT√ìN
      modalClose.addEventListener('click', closeModal, { once: false });
      
      // CERRAR POR TECLA ESCAPE
      document.addEventListener('keydown', (e) => {
        if(e.key === 'Escape' && modal.classList.contains('active')) {
          e.preventDefault();
          closeModal();
        }
      }, { passive: false });
      
      // CERRAR POR CLIC EN BACKDROP
      modal.addEventListener('click', (e) => {
        if(e.target === modal) {
          closeModal();
        }
      });
      
      // ABRIR DESDE CARDS DE AMENAZA
      document.querySelectorAll('[data-type="threat"]').forEach(card => {
        card.addEventListener('click', (e) => {
          e.stopPropagation();
          const threat = card.dataset.threat;
          openModal('threat', threat);
        });
        
        // ACCESIBILIDAD: TECLADO
        card.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            card.click();
          }
        });
      });
      
      // ABRIR DESDE CARDS DE IMAGEN
      document.querySelectorAll('[data-type="image"]').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const imageUrl = btn.dataset.image;
          openModal('image', imageUrl);
        });
        
        // ACCESIBILIDAD: TECLADO
        btn.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            btn.click();
          }
        });
      });
      
    } catch(error) {
      console.error('Error al configurar eventos:', error);
    }

    // REVEAL DE CARDS (c√≥digo original optimizado)
    const gridCards = document.querySelectorAll('.grid .card');
    const obs = new IntersectionObserver((entries, o) => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          const idx = Array.from(gridCards).indexOf(entry.target);
          entry.target.style.setProperty('--i', idx);
          const baseRange = 8 + (idx % 3) * 4;
          const range = baseRange + Math.round(Math.random()*6) + 'px';
          const dur = (3.6 + Math.random()*2.2).toFixed(2) + 's';
          const delay = (Math.random()*500).toFixed(0) + 'ms';
          entry.target.style.setProperty('--dance-range', range);
          entry.target.style.setProperty('--dance-dur', dur);
          entry.target.style.animationDelay = delay;
          entry.target.classList.add('visible');
          entry.target.classList.add('dance');
          o.unobserve(entry.target);
        }
      });
    }, { threshold: 0.12, rootMargin: '50px' });
    gridCards.forEach(c => obs.observe(c));

    // EFECTOS 3D Y SPARKS
    allCards = document.querySelectorAll('.card');
    allCards.forEach(card => {
      card.style.transition = 'transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s';
      card.addEventListener('mousemove', (e) => {
        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left; const y = e.clientY - rect.top;
        const cx = rect.width/2; const cy = rect.height/2;
        const dx = (x-cx)/cx; const dy = (y-cy)/cy;
        const rx = (dy * 6).toFixed(2); const ry = (-dx * 8).toFixed(2);
        card.style.transform = `translateY(-18px) scale(1.06) rotateX(${rx}deg) rotateY(${ry}deg) rotateZ(-0.6deg)`;
      });
      card.addEventListener('mouseenter', (e) => {
        card.style.transition='transform .12s cubic-bezier(.2,.9,.2,1), box-shadow .22s';
        for(let i=0;i<3;i++) createSpark(card, 4 + Math.random()*6);
      });
      card.addEventListener('mouseleave', ()=>{ 
        card.style.transition='transform .45s cubic-bezier(.2,.9,.2,1), box-shadow .35s'; 
        card.style.transform=''; 
      });
      const tinyShake = () => {
        if(card.matches(':hover')){ setTimeout(tinyShake, 1000 + Math.random()*2000); return; }
        const tx = (Math.random()*6 -3).toFixed(2); const ty = (Math.random()*4 -2).toFixed(2); const rot = (Math.random()*1 -0.5).toFixed(2);
        card.animate([{transform:`translate(${tx}px,${ty}px) rotate(${rot}deg)`},{transform:'translate(0px,0px) rotate(0deg)'}], {duration:420+Math.random()*600,easing:'ease-in-out'});
        setTimeout(tinyShake, 1500 + Math.random()*2600);
      };
      setTimeout(tinyShake, 400 + Math.random()*900);
    });

    function createSpark(card, size){
      const s = document.createElement('span'); s.className='spark';
      const colors = ['#fff8c6','#ffd5e8','#bff8ff','#ffd27a'];
      s.style.background = colors[Math.floor(Math.random()*colors.length)];
      const rw = card.getBoundingClientRect();
      s.style.left = Math.random()*(rw.width-20) + 'px';
      s.style.top = Math.random()*(rw.height-20) + 'px';
      s.style.opacity = '0';
      card.appendChild(s);
      s.style.width = s.style.height = (size||6) + 'px';
      const anim = s.animate([{opacity:0,transform:'scale(0.4) translateY(6px) rotate(0deg)'},{opacity:1,transform:'scale(1.1) translateY(-6px) rotate(30deg)'},{opacity:0,transform:'scale(0.6) translateY(-14px) rotate(60deg)'}], {duration:380+Math.random()*520,easing:'cubic-bezier(.2,.9,.2,1)'});
      anim.onfinish = () => s.remove();
    }

    // REDUCED MOTION
    const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
    if(mq.matches){ document.querySelectorAll('.card').forEach(c=>{ c.style.animation='none'; c.style.transition='none'; }); document.querySelectorAll('.float-shape').forEach(s=>s.style.animation='none'); }

    // GARANT√çA: Si algo falla, mostrar error visible
    window.addEventListener('error', (e) => {
      console.error('ERROR CR√çTICO:', e.error);
      document.body.innerHTML += `<div style="position:fixed;bottom:0;left:0;right:0;background:#ff004d;color:#fff;padding:10px;z-index:99999;font-family:monospace;">ERROR: ${e.message}. Revise la consola (F12)</div>`;
    });
  </script>
</body>
</html>
