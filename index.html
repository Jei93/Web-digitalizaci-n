<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Demo Interactivo ‚Äî Amenazas y Simulaciones (Ciberseguridad)</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
  :root{
    --bg-1:#071124; --bg-2:#071827; --card:#0b1b26; --glass: rgba(255,255,255,0.04);
    --accent1:#00f0ff; --accent2:#ff6a88; --muted:#9fdcff; --success:#6ee7b7; --danger:#ff7b7b;
    --radius:14px;
  }
  *{box-sizing:border-box}
  body{font-family:Inter,system-ui,-apple-system; margin:0; background:linear-gradient(180deg,var(--bg-1),#041021); color:#e8fbff; -webkit-font-smoothing:antialiased}
  .wrap{max-width:1200px;margin:28px auto;padding:20px}
  header{display:flex;align-items:center;gap:18px}
  h1{margin:0;font-size:1.8rem; background:linear-gradient(90deg,var(--accent1),#7b61ff,#ff6a88); -webkit-background-clip:text; color:transparent}
  p.lead{margin:4px 0 18px;color:var(--muted)}

  /* grid */
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px}
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
    padding:16px;border-radius:var(--radius); border:1px solid rgba(255,255,255,0.03);
    box-shadow: 0 6px 18px rgba(2,8,15,0.6); cursor:pointer; transition:transform .18s ease, box-shadow .18s ease;
    display:flex;align-items:flex-start;gap:12px;
  }
  .card:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(2,8,15,0.7) }
  .card .icon{ width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,rgba(255,255,255,0.02), rgba(255,255,255,0.01)); display:grid;place-items:center; font-size:20px }
  .card h3{margin:0;font-size:1.05rem}
  .card p{margin:8px 0 0;color:#cfeff6;font-size:0.92rem}

  /* modal */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(0,0,0,0.6),rgba(0,0,0,0.7));z-index:9999;padding:18px}
  .modal.show{display:flex}
  .panel{width:min(1100px,98%);max-height:88vh;overflow:auto;background:linear-gradient(180deg,#08111a,#05121a);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 20px 60px rgba(0,0,0,0.8)}
  .close-btn{position:absolute;right:22px;top:22px;background:transparent;border:0;color:#fff;font-size:18px;cursor:pointer}
  .demo-title{display:flex;align-items:center;gap:12px;font-weight:700;font-size:1.2rem;margin-bottom:10px}
  .demo-desc{color:var(--muted);margin-bottom:12px}

  /* email */
  .email-card{background:#021425;padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
  .email-headers{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted);font-size:0.95rem}
  .email-body{margin-top:10px;line-height:1.5;color:#e9ffff}
  .email-body a{color:var(--accent1);text-decoration:underline}

  /* file / lists */
  .file-list{display:grid;gap:8px}
  .file-item{display:flex;align-items:center;gap:12px;padding:8px;border-radius:10px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)}
  .badge{padding:6px 8px;border-radius:8px;font-weight:700;background:rgba(255,255,255,0.03);font-size:0.85rem}
  .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
  .btn.primary{background:linear-gradient(90deg,var(--accent1),#7b61ff);color:#021}
  .btn.warn{background:linear-gradient(90deg,#ff6a88,#ffb57a);color:#081}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
  .muted{color:var(--muted);font-size:0.92rem}

  /* counters */
  .counter{font-weight:900;font-size:1.9rem;color:var(--accent1)}

  /* ddos chart */
  #ddos-chart{width:100%;height:120px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);border-radius:8px;padding:8px}

  /* supply chain svg */
  #supply-svg{width:100%;height:220px;overflow:visible}

  /* data leak table */
  table{width:100%;border-collapse:collapse}
  th,td{padding:8px;border-bottom:1px solid rgba(255,255,255,0.03);text-align:left}
  .pii{font-weight:600}
  .masked{color:var(--muted)}

  /* small helpers */
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .col{flex:1}
  .note{font-size:0.9rem;color:var(--muted);margin-top:8px}
  .demo-footer{margin-top:14px;display:flex;gap:8px;flex-wrap:wrap;align-items:center}

  /* responsive tweaks */
  @media(max-width:720px){ .panel{padding:14px} .card{padding:12px} }
</style>
</head>
<body>
  <div class="wrap" role="main">
    <header>
      <div style="width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent1),#7b61ff);display:grid;place-items:center;font-weight:800;color:#021">CS</div>
      <div>
        <h1>Simulador Interactivo ‚Äî Amenazas (Demo)</h1>
        <p class="lead">Haz clic en cualquier tarjeta para ver una demo representativa y pr√°ctica. <strong>Solo demo educativo ‚Äî no ejecuta c√≥digo da√±ino.</strong></p>
      </div>
    </header>

    <section aria-label="Amenazas principales" style="margin-top:16px">
      <div class="grid">
        <div class="card" data-demo="phishing" tabindex="0" role="button" aria-pressed="false">
          <div class="icon"><i class="fa-regular fa-envelope-open-text"></i></div>
          <div>
            <h3>Phishing ‚Äî correo simulado</h3>
            <p>Correo realista con an√°lisis autom√°tico de URL y diferencias entre texto y enlace.</p>
          </div>
        </div>

        <div class="card" data-demo="malware" tabindex="0">
          <div class="icon"><i class="fa-solid fa-bug"></i></div>
          <div>
            <h3>Malware ‚Äî scanner & cuarentena</h3>
            <p>Escaneo de archivos, detecci√≥n, cuarentena visual y lista de archivos seguros.</p>
          </div>
        </div>

        <div class="card" data-demo="ransomware" tabindex="0">
          <div class="icon"><i class="fa-solid fa-lock"></i></div>
          <div>
            <h3>Ransomware ‚Äî simulaci√≥n de cifrado</h3>
            <p>Animaci√≥n de cifrado de ficheros (demo). Muestra importancia de backups.</p>
          </div>
        </div>

        <div class="card" data-demo="ddos" tabindex="0">
          <div class="icon"><i class="fa-solid fa-server"></i></div>
          <div>
            <h3>DDoS ‚Äî contador y gr√°fico</h3>
            <p>Gr√°fico en tiempo real que simula aumento de requests / s y mitigaci√≥n b√°sica.</p>
          </div>
        </div>

        <div class="card" data-demo="bruteforce" tabindex="0">
          <div class="icon"><i class="fa-solid fa-key"></i></div>
          <div>
            <h3>Fuerza Bruta ‚Äî intentos & bloqueo</h3>
            <p>Simulaci√≥n de intentos autom√°ticos, bloqueo temporal y 2FA recomendada.</p>
          </div>
        </div>

        <div class="card" data-demo="social" tabindex="0">
          <div class="icon"><i class="fa-solid fa-user-secret"></i></div>
          <div>
            <h3>Ingenier√≠a Social ‚Äî llamadas y chat</h3>
            <p>Ejemplo de mensaje y checklist para detectar suplantaci√≥n social.</p>
          </div>
        </div>

        <div class="card" data-demo="supply" tabindex="0">
          <div class="icon"><i class="fa-solid fa-sitemap"></i></div>
          <div>
            <h3>Supply-Chain ‚Äî nodo comprometido</h3>
            <p>Gr√°fico de dependencias: al comprometer un nodo ver√°s propagaci√≥n visual del impacto.</p>
          </div>
        </div>

        <div class="card" data-demo="cloud" tabindex="0">
          <div class="icon"><i class="fa-solid fa-cloud"></i></div>
          <div>
            <h3>Nube ‚Äî bucket p√∫blico/privado</h3>
            <p>Escanea permisos y muestra riesgo si el bucket es p√∫blico.</p>
          </div>
        </div>

        <div class="card" data-demo="iot" tabindex="0">
          <div class="icon"><i class="fa-solid fa-wifi"></i></div>
          <div>
            <h3>IoT ‚Äî inventario y parches</h3>
            <p>Lista de dispositivos, niveles de riesgo y bot√≥n "Parchear todo".</p>
          </div>
        </div>

        <div class="card" data-demo="dataleak" tabindex="0">
          <div class="icon"><i class="fa-solid fa-database"></i></div>
          <div>
            <h3>Data Leak ‚Äî datos expuestos</h3>
            <p>Tabla con PII parcialmente enmascarada y herramienta para generar e-mail de notificaci√≥n.</p>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Modal √∫nico -->
  <div id="modal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="panel" role="document" aria-live="polite">
      <button class="close-btn" id="closeModal" aria-label="Cerrar demo"><i class="fa-solid fa-xmark"></i></button>
      <div id="modalContent"></div>
      <div class="demo-footer">
        <div class="muted">Demo educativo ‚Äî no realiza acciones en tu dispositivo.</div>
      </div>
    </div>
  </div>

<script>
/* ----------------------
  Helpers y utilidades
   ---------------------- */
const modal = document.getElementById('modal');
const modalContent = document.getElementById('modalContent');
const closeModalBtn = document.getElementById('closeModal');

function openModal(html){
  modalContent.innerHTML = html;
  modal.classList.add('show'); modal.setAttribute('aria-hidden','false');
  // focus first focusable
  setTimeout(()=>{ const f = modal.querySelector('button, a, input, textarea'); if(f) f.focus(); },50);
}
function closeModal(){
  modal.classList.remove('show'); modal.setAttribute('aria-hidden','true'); modalContent.innerHTML='';
}
closeModalBtn.addEventListener('click', closeModal);
modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });
document.addEventListener('keydown', e=>{ if(e.key==='Escape' && modal.classList.contains('show')) closeModal(); });

/* Attach tarjetas */
document.querySelectorAll('[data-demo]').forEach(el=>{
  el.addEventListener('click', ()=> openDemo(el.dataset.demo));
  el.addEventListener('keydown', e=>{ if(e.key==='Enter' || e.key===' ') openDemo(el.dataset.demo); });
});

/* Small toast */
function toast(msg, t=2200){
  const d = document.createElement('div'); d.style.position='fixed'; d.style.right='20px'; d.style.bottom='20px';
  d.style.background='#072229'; d.style.padding='10px 12px'; d.style.borderRadius='10px'; d.style.boxShadow='0 10px 30px rgba(0,0,0,0.6)';
  d.style.color='#eafcff'; d.textContent = msg; document.body.appendChild(d);
  setTimeout(()=>{ d.style.transition='opacity .5s'; d.style.opacity='0'; }, t); setTimeout(()=> d.remove(), t+700);
}

/* safe random words for demo */
const samplePasswords = ['123456','password','qwerty','welcome','letmein','admin','secret123','2025pass','change_me','P@ssw0rd!'];

/* ----------------------
   Demos
   ---------------------- */
function openDemo(type){
  switch(type){
    case 'phishing': openModal(phishingHTML()); attachPhishingLogic(); break;
    case 'malware': openModal(malwareHTML()); attachMalwareLogic(); break;
    case 'ransomware': openModal(ransomwareHTML()); attachRansomLogic(); break;
    case 'ddos': openModal(ddosHTML()); attachDdosLogic(); break;
    case 'bruteforce': openModal(bruteforceHTML()); attachBruteforceLogic(); break;
    case 'social': openModal(socialHTML()); attachSocialLogic(); break;
    case 'supply': openModal(supplyHTML()); attachSupplyLogic(); break;
    case 'cloud': openModal(cloudHTML()); attachCloudLogic(); break;
    case 'iot': openModal(iotHTML()); attachIotLogic(); break;
    case 'dataleak': openModal(dataleakHTML()); attachDataLeakLogic(); break;
    default: openModal('<h2>Demo</h2><p>No implementado</p>');
  }
}

/* =========================
   PHISHING - HTML + logic
   ========================= */
function phishingHTML(){
  const now = new Date().toLocaleString();
  return `
    <div class="demo-title"><i class="fa-regular fa-envelope-open-text"></i> PHISHING ‚Äî Correo simulado</div>
    <div class="demo-desc">Aqu√≠ tienes un correo realista: observa el texto mostrado y el enlace real. El analizador te dir√° si hay discrepancias comunes (dominio distinto, subdominio enga√±oso, punycode, etc.).</div>

    <div class="email-card" aria-live="polite">
      <div class="email-headers">
        <div><strong>De:</strong> soporte@banco-oficial.com</div>
        <div><strong>Para:</strong> t√∫@ejemplo.com</div>
        <div><strong>Fecha:</strong> ${now}</div>
      </div>

      <div class="email-body">
        <p>Hola cliente,</p>
        <p>Hemos detectado actividad inusual en su cuenta. Para evitar el bloqueo, <strong>verifique su cuenta</strong> en las pr√≥ximas 24h pulsando el siguiente enlace:</p>
        <p><a href="https://banco-oficial.login-secure-verify.example.com/verify?user=abc" id="phish-link">https://banco-oficial.com/verify</a></p>
        <p>Si no realiza esta acci√≥n su cuenta ser√° temporalmente restringida.</p>
        <p>Atentamente,<br>Equipo de Soporte</p>
      </div>

      <div style="margin-top:12px" class="row">
        <button id="analyzeLink" class="btn primary"><i class="fa-solid fa-magnifying-glass"></i> Analizar enlace</button>
        <button id="markPhish" class="btn ghost"><i class="fa-solid fa-flag"></i> Marcar como phishing</button>
        <div style="margin-left:auto" class="badge">DEMO</div>
      </div>

      <div id="phish-result" style="margin-top:12px"></div>
    </div>

    <div class="note">Recomendaci√≥n: nunca abras enlaces desde correos no esperados. Verifica dominio, HTTPS y sustituye el enlace por escribir la URL en el navegador manualmente.</div>
  `;
}

/* Phishing logic: compara texto del enlace con href real y detecta diferencias simples */
function attachPhishingLogic(){
  const link = document.getElementById('phish-link');
  const result = document.getElementById('phish-result');
  document.getElementById('analyzeLink').addEventListener('click', ()=>{
    const shown = link.textContent.trim();
    const href = link.getAttribute('href');
    const parsedShown = extractDomain(shown);
    const parsedHref = extractDomain(href);
    const issues = [];

    if(parsedShown !== parsedHref) issues.push(`Dominio visible (${parsedShown}) difiere del dominio real (${parsedHref}).`);
    if(href.includes('login-secure') || href.includes('verify') || href.includes('secure')) issues.push('URL contiene palabras que suelen usarse para enga√±ar (login, secure, verify).');
    if(href.includes('xn--')) issues.push('Posible uso de punycode -> dominio punycode (car√°cter Unicode similar a ASCII).');

    if(issues.length===0){
      result.innerHTML = `<div class="muted">Analizador: no se detectaron discrepancias evidentes (demo). Aun as√≠, verifica certificado HTTPS y dominio principal manualmente.</div>`;
    } else {
      result.innerHTML = `<div style="padding:10px;border-radius:8px;background:rgba(255,120,120,0.06);border:1px solid rgba(255,80,80,0.06)"><strong style="color:var(--danger)">Posibles problemas:</strong><ul style="margin:8px 0 0 18px;color:#ffd7d7">${issues.map(i=>`<li>${i}</li>`).join('')}</ul></div>`;
    }
    toast('An√°lisis completado (demo)');
  });

  document.getElementById('markPhish').addEventListener('click', ()=>{
    link.style.textDecoration='line-through'; link.style.color='#ff9fb3';
    toast('Correo marcado como phishing (demo)');
  });
}

/* domain extractor simple */
function extractDomain(url){
  try{
    if(!url.includes('://')) url = 'https://'+url;
    const u = new URL(url);
    return u.hostname.replace(/^www\./,'');
  }catch(e){ return url; }
}

/* =========================
   MALWARE - HTML + logic
   ========================= */
function malwareHTML(){
  return `
    <div class="demo-title"><i class="fa-solid fa-bug"></i> MALWARE ‚Äî Esc√°ner y cuarentena</div>
    <div class="demo-desc">Lista de archivos detectados en un correo/descarga. Pulsa "Analizar" para simular un motor antivirus y enviar a cuarentena.</div>

    <div class="row" style="gap:16px">
      <div class="col">
        <div class="file-list" id="fileList">
          <div class="file-item"><div style="width:36px;height:36;border-radius:8px;background:#10212a;display:grid;place-items:center"><i class="fa-solid fa-file"></i></div><div style="flex:1"><strong>invoice_v1.exe</strong><div class="muted">1.2 MB ¬∑ ejecutable</div></div><div><button class="btn primary" data-file="invoice_v1.exe">Analizar</button></div></div>
          <div class="file-item"><div style="width:36px;height:36;border-radius:8px;background:#10212a;display:grid;place-items:center"><i class="fa-solid fa-file-zipper"></i></div><div style="flex:1"><strong>docs_backup.zip</strong><div class="muted">2.1 MB ¬∑ zip</div></div><div><button class="btn ghost" data-file="docs_backup.zip">Analizar</button></div></div>
          <div class="file-item"><div style="width:36px;height:36;border-radius:8px;background:#10212a;display:grid;place-items:center"><i class="fa-solid fa-file-code"></i></div><div style="flex:1"><strong>update.msi</strong><div class="muted">0.9 MB ¬∑ instalador</div></div><div><button class="btn ghost" data-file="update.msi">Analizar</button></div></div>
        </div>
      </div>

      <div style="width:300px">
        <div style="padding:12px;border-radius:10px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)">
          <div class="muted">Cuarentena</div>
          <div id="quarantine" style="margin-top:8px"></div>
          <div style="margin-top:12px">
            <button id="viewReport" class="btn ghost"><i class="fa-solid fa-file-lines"></i> Ver informe (demo)</button>
          </div>
        </div>
      </div>
    </div>
    <div class="note">Acci√≥n simulada: el bot√≥n "Analizar" ejecuta un proceso demo que puede marcar un archivo como malicioso y moverlo a cuarentena.</div>
  `;
}

function attachMalwareLogic(){
  const fileList = document.getElementById('fileList');
  const quarantine = document.getElementById('quarantine');

  fileList.querySelectorAll('button[data-file]').forEach(btn=>{
    btn.addEventListener('click', async ()=>{
      const name = btn.dataset.file;
      btn.disabled = true; btn.textContent = 'Escaneando...';
      // animaci√≥n demo
      await new Promise(r => setTimeout(r, 1000 + Math.random()*900));
      // heur√≠stica demo: .exe o .msi -> malicioso; zip -> limpio (demo)
      const malicious = name.endsWith('.exe') || name.endsWith('.msi');
      if(malicious){
        btn.textContent = 'Peligroso';
        btn.classList.remove('primary'); btn.classList.add('warn');
        // mover a cuarentena
        const item = document.createElement('div'); item.style.padding='6px 8px'; item.style.marginTop='6px'; item.style.borderRadius='8px';
        item.style.background='rgba(255,120,120,0.04)'; item.innerHTML = `<strong>${name}</strong> <div class="muted">Detectado como malicioso (demo)</div>`;
        quarantine.appendChild(item);
        toast(`${name} enviado a cuarentena (demo)`);
      } else {
        btn.textContent = 'OK';
        btn.classList.remove('primary'); btn.classList.add('ghost');
        toast(`${name} parece limpio (demo)`);
      }
    });
  });

  document.getElementById('viewReport').addEventListener('click', ()=> {
    alert('Informe demo: 3 archivos analizados, 1 detectado como malicioso. Recomendaci√≥n: no ejecutar .exe desde remitentes desconocidos y mantener antivirus actualizado.');
  });
}

/* =========================
   RANSOMWARE - HTML + logic
   ========================= */
function ransomwareHTML(){
  return `
    <div class="demo-title"><i class="fa-solid fa-lock"></i> RANSOMWARE ‚Äî Simulaci√≥n</div>
    <div class="demo-desc">Simula cifrado de archivos (solo en la interfaz). Al cifrar ver√°s c√≥mo cambian los nombres y aparece una nota de rescate. Incluye bot√≥n de "Restaurar desde backup" para la demo.</div>

    <div class="file-list" id="ransom-files" aria-live="polite">
      <div class="file-item"><div style="width:36px;height:36;border-radius:8px;background:#10212a;display:grid;place-items:center"><i class="fa-solid fa-photo-film"></i></div><div style="flex:1"><strong>fotos_vacaciones.jpg</strong><div class="muted">3.2 MB</div></div><div><span class="badge">OK</span></div></div>
      <div class="file-item"><div style="width:36px;height:36;border-radius:8px;background:#10212a;display:grid;place-items:center"><i class="fa-solid fa-file-lines"></i></div><div style="flex:1"><strong>proyecto_final.docx</strong><div class="muted">1.1 MB</div></div><div><span class="badge">OK</span></div></div>
      <div class="file-item"><div style="width:36px;height:36;border-radius:8px;background:#10212a;display:grid;place-items:center"><i class="fa-solid fa-database"></i></div><div style="flex:1"><strong>backup-config.tar</strong><div class="muted">12 MB</div></div><div><span class="badge">OK</span></div></div>
    </div>

    <div style="margin-top:12px" class="row">
      <button id="ransom-start" class="btn warn"><i class="fa-solid fa-bolt"></i> Iniciar cifrado (demo)</button>
      <button id="ransom-restore" class="btn ghost" disabled><i class="fa-solid fa-database"></i> Restaurar desde backup</button>
      <div style="margin-left:auto" class="muted">Nota: restauraci√≥n solo reproduce los nombres originales (demo).</div>
    </div>

    <div id="ransom-note" style="margin-top:12px;display:none;padding:12px;border-radius:8px;background:#2a0c12;border:1px solid rgba(255,255,255,0.02)">
      <strong style="color:var(--danger)">ARCHIVOS CIFRADOS</strong>
      <p class="muted" style="margin:6px 0 0">Sus archivos han sido cifrados. Para recuperar los datos, siga las instrucciones (demo). <em>Esta es una nota de rescate simulada</em>.</p>
    </div>
  `;
}

function attachRansomLogic(){
  const start = document.getElementById('ransom-start');
  const restore = document.getElementById('ransom-restore');
  const list = document.getElementById('ransom-files');
  const note = document.getElementById('ransom-note');
  const originalNames = [];

  // store original names
  list.querySelectorAll('.file-item strong').forEach(s=> originalNames.push(s.textContent));

  start.addEventListener('click', ()=>{
    start.disabled = true; start.textContent = 'Cifrando...';
    note.style.display = 'block';
    // animate: replace each name with "ENCRYPTED_XXXX"
    const items = Array.from(list.querySelectorAll('.file-item strong'));
    let i = 0;
    const iv = setInterval(()=>{
      if(i >= items.length){ clearInterval(iv); start.textContent='Cifrado (demo)'; restore.disabled = false; toast('Archivos cifrados (demo) ‚Äî recuerda backups'); return; }
      const el = items[i];
      el.dataset.orig = el.textContent;
      const rnd = Math.random().toString(36).slice(2,8).toUpperCase();
      el.textContent = `ENCRYPTED_${rnd}.locked`;
      el.parentElement.nextElementSibling.querySelector('.badge').textContent = 'CIFRADO';
      el.parentElement.nextElementSibling.querySelector('.badge').style.background='linear-gradient(90deg,#ff6a88,#ffb57a)';
      i++;
    }, 700);
  });

  restore.addEventListener('click', ()=>{
    const items = Array.from(list.querySelectorAll('.file-item strong'));
    items.forEach((el, idx)=>{ el.textContent = originalNames[idx]; el.parentElement.nextElementSibling.querySelector('.badge').textContent='OK'; el.parentElement.nextElementSibling.querySelector('.badge').style.background='rgba(255,255,255,0.03)'; });
    note.style.display='none';
    restore.disabled = true;
    start.disabled = false; start.textContent = 'Iniciar cifrado (demo)';
    toast('Restauraci√≥n desde backup simulada (demo). Recuerda tener backups offline y versionados en la realidad.');
  });
}

/* =========================
   DDOS - HTML + logic (canvas)
   ========================= */
function ddosHTML(){
  return `
    <div class="demo-title"><i class="fa-solid fa-server"></i> DDoS ‚Äî Tr√°fico simulado</div>
    <div class="demo-desc">Observa un gr√°fico de requests/segundo y activa un "ataque" demo. Muestra c√≥mo la capacidad puede saturarse.</div>

    <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
      <div style="flex:1">
        <div id="ddos-chart"></div>
      </div>
      <div style="width:220px">
        <div class="muted">Requests / s</div>
        <div class="counter" id="ddos-counter">0</div>
        <div style="margin-top:12px" class="row">
          <button id="ddos-start" class="btn warn"><i class="fa-solid fa-play"></i> Iniciar</button>
          <button id="ddos-stop" class="btn ghost"><i class="fa-solid fa-stop"></i> Parar</button>
        </div>
        <div class="note">Mitigaci√≥n demo: activar WAF y rate-limit reduce picos (simulado).</div>
      </div>
    </div>
  `;
}

function attachDdosLogic(){
  // simple canvas chart drawing
  const chart = document.getElementById('ddos-chart');
  chart.innerHTML = '<canvas id="ddosCanvas" width="800" height="120" style="width:100%;height:120px"></canvas>';
  const canvas = document.getElementById('ddosCanvas');
  const ctx = canvas.getContext('2d');
  function resize(){ canvas.width = canvas.clientWidth*devicePixelRatio; canvas.height = 120*devicePixelRatio; ctx.scale(devicePixelRatio, devicePixelRatio); }
  resize(); window.addEventListener('resize', ()=>{ resize(); draw(data); });
  const data = Array(40).fill(10);
  function draw(arr){
    // clear
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // background
    ctx.fillStyle = 'rgba(255,255,255,0.02)'; ctx.fillRect(0,0,canvas.clientWidth,120);
    // path
    const w = canvas.clientWidth; const h = 120;
    ctx.beginPath(); ctx.moveTo(0, h - (arr[0]/120)*h);
    for(let i=1;i<arr.length;i++){
      const x = (i/(arr.length-1))*w; const y = h - (arr[i]/120)*h; ctx.lineTo(x,y);
    }
    ctx.strokeStyle = 'rgba(0,240,255,0.9)'; ctx.lineWidth=2; ctx.stroke();
    // area
    ctx.lineTo(w,h); ctx.lineTo(0,h); ctx.closePath();
    const g = ctx.createLinearGradient(0,0,0,h); g.addColorStop(0,'rgba(0,240,255,0.12)'); g.addColorStop(1,'rgba(0,240,255,0.01)');
    ctx.fillStyle = g; ctx.fill();
  }
  draw(data);

  const counter = document.getElementById('ddos-counter');
  let interval=null;
  document.getElementById('ddos-start').addEventListener('click', ()=>{
    if(interval) return;
    interval = setInterval(()=>{
      // push new value with randomness (simulate attack increase)
      const last = data[data.length-1];
      let next = last + Math.floor(Math.random()*180 + 20);
      if(next > 1800) next = 1800; // cap demo
      data.push(next); data.shift();
      draw(data); counter.textContent = next.toLocaleString();
    }, 300);
    toast('Ataque simulado iniciado (demo)');
  });
  document.getElementById('ddos-stop').addEventListener('click', ()=>{
    clearInterval(interval); interval=null;
    // decay
    const decay = setInterval(()=>{
      const last = data[data.length-1];
      const next = Math.max(8, Math.floor(last * 0.75));
      data.push(next); data.shift(); draw(data); counter.textContent = next.toLocaleString();
      if(next <= 10){ clearInterval(decay); counter.textContent='0'; toast('Tr√°fico normalizado (demo)'); }
    }, 300);
  });
}

/* =========================
   BRUTE FORCE - HTML + logic
   ========================= */
function bruteforceHTML(){
  return `
    <div class="demo-title"><i class="fa-solid fa-key"></i> FUERZA BRUTA ‚Äî Intentos</div>
    <div class="demo-desc">Prueba login con m√∫ltiples intentos. Si hay X fallos seguidos la cuenta se bloquea temporalmente. Se muestran recomendaciones (2FA, bloqueo por IP).</div>

    <div style="display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap">
      <div style="width:320px">
        <div style="padding:12px;border-radius:10px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)">
          <label class="muted">Usuario</label>
          <input id="bf-user" value="admin" style="width:100%;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:#eafcff" />
          <label class="muted" style="margin-top:8px;display:block">Contrase√±a</label>
          <input id="bf-pass" type="password" style="width:100%;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:#eafcff" />
          <div style="margin-top:10px" class="row">
            <button id="bf-try" class="btn primary"><i class="fa-solid fa-right-to-bracket"></i> Intentar login</button>
            <button id="bf-auto" class="btn ghost"><i class="fa-solid fa-gear"></i> Simular fuerza bruta</button>
          </div>
          <div id="bf-info" style="margin-top:8px" class="muted">Intentos: 0 ¬∑ Estado: OK</div>
        </div>
      </div>

      <div style="flex:1">
        <div class="muted">Registro de intentos (demo)</div>
        <div id="bf-log" style="margin-top:8px;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01);height:150px;overflow:auto"></div>
        <div class="note" style="margin-top:8px">Consejo: activa 2FA y bloquea IP tras varios intentos. Implementa rate limiting.</div>
      </div>
    </div>
  `;
}

function attachBruteforceLogic(){
  const tryBtn = document.getElementById('bf-try');
  const autoBtn = document.getElementById('bf-auto');
  const log = document.getElementById('bf-log');
  const info = document.getElementById('bf-info');
  const userInput = document.getElementById('bf-user');
  const passInput = document.getElementById('bf-pass');
  let attempts = 0;
  const MAX = 6;
  let lockedUntil = null;
  function updateInfo(){ info.textContent = `Intentos: ${attempts} ¬∑ Estado: ${lockedUntil && Date.now() < lockedUntil ? 'BLOQUEADA' : 'OK'}`; }

  tryBtn.addEventListener('click', ()=>{
    if(lockedUntil && Date.now() < lockedUntil){ toast('Cuenta bloqueada temporalmente (demo)'); updateInfo(); return; }
    attempts++;
    const pass = passInput.value || '';
    // demo: password 's3cret!' is correct
    const success = pass === 's3cret!';
    const row = document.createElement('div'); row.style.padding='6px 0'; row.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong> ‚Äî user: ${userInput.value} ‚Äî pass: ${pass} ‚Äî ${success ? '<span style="color:#6ee7b7">√âxito</span>' : '<span style="color:#ff9fb3">Fallido</span>'}`;
    log.prepend(row);
    if(success){ toast('Acceso concedido (demo)'); attempts = 0; }
    if(!success && attempts >= MAX){
      lockedUntil = Date.now() + 30*1000; // bloquea 30s en demo
      toast('Cuenta bloqueada por varios intentos (demo)');
    }
    updateInfo();
  });

  let autoInterval = null;
  autoBtn.addEventListener('click', ()=>{
    if(autoInterval){ clearInterval(autoInterval); autoInterval = null; autoBtn.textContent='Simular fuerza bruta'; return; }
    autoBtn.textContent='Parar simulaci√≥n';
    autoInterval = setInterval(()=>{
      const fakePass = samplePasswords[Math.floor(Math.random()*samplePasswords.length)] + Math.floor(Math.random()*999);
      passInput.value = fakePass;
      tryBtn.click();
      if(lockedUntil && Date.now() < lockedUntil){ clearInterval(autoInterval); autoInterval=null; autoBtn.textContent='Simular fuerza bruta'; }
    }, 600);
  });

  updateInfo();
}

/* =========================
   SOCIAL ENGINEERING
   ========================= */
function socialHTML(){
  return `
    <div class="demo-title"><i class="fa-solid fa-user-secret"></i> INGENIER√çA SOCIAL ‚Äî Chat & Llamada</div>
    <div class="demo-desc">Ejemplo de mensaje/llamada fraudulenta. Usa el bot√≥n "Ver se√±ales" para listar banderas rojas t√≠picas.</div>

    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <div style="flex:1">
        <div style="padding:12px;border-radius:10px;background:#021426;border:1px solid rgba(255,255,255,0.02);">
          <div style="font-weight:700">Soporte T√©cnico</div>
          <div class="muted">Hola, soy Ana del soporte. Hemos detectado acceso sospechoso. Necesitamos su PIN para verificar inmediatamente.</div>
        </div>
      </div>

      <div style="width:260px">
        <button id="social-check" class="btn primary"><i class="fa-solid fa-eye"></i> Ver se√±ales sospechosas</button>
        <button id="social-report" class="btn ghost" style="margin-left:8px"><i class="fa-solid fa-flag"></i> Reportar</button>
      </div>
    </div>

    <div id="social-result" style="margin-top:12px"></div>
  `;
}

function attachSocialLogic(){
  document.getElementById('social-check').addEventListener('click', ()=>{
    const issues = [
      'Urgencia no justificada: presi√≥n para actuar ahora.',
      'Petici√≥n de datos sensibles (PIN, contrase√±as).',
      'Falta de verificaci√≥n: no hay caller ID ni referencia interna.',
      'Saludo gen√©rico y falta de contexto t√©cnico.',
    ];
    document.getElementById('social-result').innerHTML = `<div style="padding:10px;border-radius:8px;background:rgba(255,255,255,0.01)"><strong>Se√±ales detectadas (demo):</strong><ul style="margin:8px 0 0 18px">${issues.map(i=>`<li>${i}</li>`).join('')}</ul></div>`;
    toast('Se√±ales mostradas (demo)');
  });
  document.getElementById('social-report').addEventListener('click', ()=>{ toast('Reportado a equipo interno (demo)'); });
}

/* =========================
   SUPPLY CHAIN - graph + logic
   ========================= */
function supplyHTML(){
  return `
    <div class="demo-title"><i class="fa-solid fa-sitemap"></i> SUPPLY-CHAIN ‚Äî Dependencias</div>
    <div class="demo-desc">Haz clic en un nodo para marcarlo como comprometido y observa la propagaci√≥n visual a dependientes.</div>
    <svg id="supply-svg" viewBox="0 0 800 280" preserveAspectRatio="xMidYMid meet"></svg>
    <div class="note">En la realidad: controla la integridad de dependencias, firma de paquetes y revisiones de proveedores.</div>
  `;
}

function attachSupplyLogic(){
  const svg = document.getElementById('supply-svg');
  // nodes with dependencies (simple)
  const nodes = [
    {id:'N1', x:120, y:60, label:'Proveedor A', deps:['N3']},
    {id:'N2', x:320, y:60, label:'Librer√≠a B', deps:['N3']},
    {id:'N3', x:520, y:60, label:'SDK com√∫n', deps:['N4']},
    {id:'N4', x:360, y:180, label:'TuApp', deps:[]},
  ];
  // draw edges first
  svg.innerHTML = '';
  const ns = 'http://www.w3.org/2000/svg';
  nodes.forEach(n=>{
    n.deps.forEach(d=>{
      const target = nodes.find(x=>x.id===d);
      const line = document.createElementNS(ns,'line');
      line.setAttribute('x1', n.x); line.setAttribute('y1', n.y+8); line.setAttribute('x2', target.x); line.setAttribute('y2', target.y-8);
      line.setAttribute('stroke','rgba(255,255,255,0.06)'); line.setAttribute('stroke-width','2'); svg.appendChild(line);
    });
  });
  // draw nodes
  nodes.forEach(n=>{
    const g = document.createElementNS(ns,'g'); g.setAttribute('transform',`translate(${n.x},${n.y})`); g.style.cursor='pointer';
    const circ = document.createElementNS(ns,'circle'); circ.setAttribute('r','30'); circ.setAttribute('fill','#071827'); circ.setAttribute('stroke','rgba(255,255,255,0.04)');
    const txt = document.createElementNS(ns,'text'); txt.setAttribute('y','6'); txt.setAttribute('x','0'); txt.setAttribute('text-anchor','middle'); txt.setAttribute('fill','#dff7fb'); txt.setAttribute('font-size','12'); txt.textContent = n.id;
    const label = document.createElementNS(ns,'text'); label.setAttribute('y','50'); label.setAttribute('x','0'); label.setAttribute('text-anchor','middle'); label.setAttribute('fill','#9fdcff'); label.setAttribute('font-size','11'); label.textContent = n.label;
    g.appendChild(circ); g.appendChild(txt); g.appendChild(label);
    g.addEventListener('click', ()=>{
      // mark compromised and animate propagation
      circ.setAttribute('fill','#ff6a88');
      toast(`${n.label} comprometido (demo)`);
      // ripple to dependents: simple timeout
      setTimeout(()=> {
        nodes.filter(x=>x.deps.includes(n.id)).forEach(dep=>{
          // find the svg circle of dep
          const el = Array.from(svg.querySelectorAll('g')).find(g2=> g2.querySelector('text').textContent === dep.id);
          if(el){ el.querySelector('circle').setAttribute('fill','#ffb57a'); }
        });
      }, 600);
    });
    svg.appendChild(g);
  });
}

/* =========================
   CLOUD - bucket public/private
   ========================= */
function cloudHTML(){
  return `
    <div class="demo-title"><i class="fa-solid fa-cloud"></i> NUBE ‚Äî Bucket p√∫blico/privado</div>
    <div class="demo-desc">Simula permisos de un bucket. Marca p√∫blico y pulsa "Escanear" para ver archivos expuestos.</div>

    <div style="display:flex;gap:12px;align-items:center">
      <div style="flex:1">
        <div style="padding:12px;border-radius:10px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)">
          <div style="display:flex;align-items:center;gap:8px">
            <strong>mi-backup-2025</strong>
            <div class="muted">¬∑ Contenido: configs, backups, fotos</div>
          </div>
          <div style="margin-top:10px" class="row">
            <label class="muted">P√∫blico <input type="checkbox" id="bucketPublic" checked style="margin-left:8px"></label>
            <button id="bucketScan" class="btn primary">Escanear</button>
          </div>
          <div id="bucketResult" style="margin-top:10px"></div>
        </div>
      </div>

      <div style="width:300px">
        <div style="padding:12px;border-radius:10px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)">
          <div class="muted">URL de ejemplo</div>
          <div style="margin-top:8px"><code id="bucketUrl">https://storage.example.com/mi-backup-2025/</code></div>
          <div class="note" style="margin-top:8px">Nota: Cerrar acceso p√∫blico o usar pol√≠ticas de IAM restrictivas.</div>
        </div>
      </div>
    </div>
  `;
}

function attachCloudLogic(){
  document.getElementById('bucketScan').addEventListener('click', ()=>{
    const pub = document.getElementById('bucketPublic').checked;
    const out = document.getElementById('bucketResult');
    if(pub){
      out.innerHTML = `<div style="padding:10px;border-radius:8px;background:rgba(255,120,120,0.04)"><strong style="color:var(--danger)">Riesgo:</strong> bucket p√∫blico. Archivos expuestos:</div>
        <ul style="margin-top:8px">
          <li>config/db_credentials.yml</li>
          <li>backups/database-2025-07.sql</li>
          <li>photos/private/CEO.jpg</li>
        </ul>`;
      toast('Bucket p√∫blico detectado (demo)');
    } else {
      out.innerHTML = `<div style="padding:10px;border-radius:8px;background:rgba(110,231,183,0.04)"><strong style="color:var(--success)">OK</strong> ‚Äî bucket privado.</div>`;
      toast('Bucket restringido (demo)');
    }
  });
}

/* =========================
   IOT - inventory + patch
   ========================= */
function iotHTML(){
  return `
    <div class="demo-title"><i class="fa-solid fa-wifi"></i> I√òT ‚Äî Dispositivos</div>
    <div class="demo-desc">Inventario con nivel de riesgo y botones para parcheo (demo).</div>

    <div class="file-list">
      <div class="file-item"><div style="width:36px;height:36;border-radius:8px;display:grid;place-items:center">üì∑</div><div style="flex:1"><strong>Camara-entrada</strong><div class="muted">Firmware v1.0 ‚Äî Exposici√≥n: ALTA</div></div><div><button class="btn warn patch" data-device="Camara-entrada">Parchear</button></div></div>
      <div class="file-item"><div style="width:36px;height:36;border-radius:8px;display:grid;place-items:center">üå°Ô∏è</div><div style="flex:1"><strong>Termostato</strong><div class="muted">Firmware v2.3 ‚Äî Exposici√≥n: BAJA</div></div><div><button class="btn ghost patch" data-device="Termostato">Parchear</button></div></div>
      <div style="margin-top:8px"><button id="patchAll" class="btn primary"><i class="fa-solid fa-wrench"></i> Parchear todo</button></div>
    </div>
  `;
}

function attachIotLogic(){
  document.querySelectorAll('.patch').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      btn.disabled = true; btn.textContent = 'Parcheando...';
      setTimeout(()=>{ btn.textContent = 'Parcheado'; btn.classList.remove('warn'); btn.classList.add('ghost'); toast(`${btn.dataset.device} actualizado (demo)`); }, 900 + Math.random()*800);
    });
  });
  document.getElementById('patchAll').addEventListener('click', ()=>{
    document.querySelectorAll('.patch').forEach(b=> b.click());
  });
}

/* =========================
   DATA LEAK - table + logic
   ========================= */
function dataleakHTML(){
  return `
    <div class="demo-title"><i class="fa-solid fa-database"></i> DATA LEAK ‚Äî Datos expuestos</div>
    <div class="demo-desc">Tabla con PII enmascarada. Puedes mostrar (demo) o redactar, y generar una plantilla de notificaci√≥n.</div>

    <table>
      <thead><tr><th>Nombre</th><th>DNI</th><th>Email</th></tr></thead>
      <tbody id="leakTable">
        <tr><td>Mar√≠a P√©rez</td><td class="pii masked">123.456.78A</td><td class="pii masked">maria.perez@example.com</td></tr>
        <tr><td>Carlos Ruiz</td><td class="pii masked">987.654.32B</td><td class="pii masked">carlos.ruiz@example.com</td></tr>
        <tr><td>Ana L√≥pez</td><td class="pii masked">456.789.01C</td><td class="pii masked">ana.lopez@example.com</td></tr>
      </tbody>
    </table>

    <div style="margin-top:10px" class="row">
      <button id="unmask" class="btn primary">Mostrar datos (demo)</button>
      <button id="redact" class="btn ghost">Redactar PII</button>
      <button id="genMail" class="btn warn">Generar e-mail de notificaci√≥n</button>
    </div>

    <div id="mailArea" style="margin-top:12px"></div>
  `;
}

function attachDataLeakLogic(){
  const unmask = document.getElementById('unmask');
  const redact = document.getElementById('redact');
  const genMail = document.getElementById('genMail');
  const table = document.getElementById('leakTable');
  const mailArea = document.getElementById('mailArea');

  unmask.addEventListener('click', ()=>{
    table.querySelectorAll('.masked').forEach(td=> td.classList.remove('masked'));
    toast('Datos mostrados (demo) ‚Äî en producci√≥n redacta o elimina PII antes de publicar.');
  });

  redact.addEventListener('click', ()=>{
    table.querySelectorAll('.pii').forEach(td=>{
      td.textContent = td.textContent.replace(/(.{2}).+(.{2})/,'$1***$2');
      td.classList.add('masked');
    });
    toast('PII redactada (demo).');
  });

  genMail.addEventListener('click', ()=>{
    const subject = 'Notificaci√≥n de fuga de datos ‚Äî Acciones requeridas';
    const body = `Estimado/a,\n\nLe informamos que hemos detectado una exposici√≥n de datos personales el ${new Date().toLocaleDateString()}. Los datos potencialmente afectados incluyen nombres y correos electr√≥nicos. Hemos tomado medidas inmediatas para contener el incidente y recomendamos:\n\n- Cambiar contrase√±as asociadas.\n- Activar 2FA.\n- Revisar actividad inusual.\n\nAtentamente,\nEquipo de Seguridad (demo)`;
    mailArea.innerHTML = `<div style="padding:10px;border-radius:8px;background:rgba(255,255,255,0.01)"><strong>Asunto:</strong> ${subject}<pre style="margin-top:8px;background:transparent;border-left:3px solid rgba(255,255,255,0.02);padding-left:8px">${body}</pre></div>`;
    toast('Plantilla de notificaci√≥n generada (demo)');
  });
}

/* END of demos */
</script>

</body>
</html>
